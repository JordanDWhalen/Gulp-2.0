function minWidth(e){var i=$(window).width();return i>=e}function maxWidth(e){var i=$(window).width();return e>=i}function positionFauxed(e){var i=parseInt($("header.global").height(),10),s=$(window).scrollTop()-i,l=parseInt($("main.noscroll").css("top"),10)-i;l=parseInt(l,10),l=-1*l,e===!0?($("main").addClass("noscroll"),$("main").css("top",+(-1*s))):setTimeout(function(){$("main").removeClass("noscroll"),$("main").css("top","0"),$(window).scrollTop(l)},1)}function ug_gridSliderLayout(){$(".ug.grid-slider").each(function(e,i){$(this).addClass(""+e);var s=$(this).attr("class").split(" ").pop(),l=$(".ug.grid-slider."+s+" .wrapper a");if(console.log(l),l.parent().is(".slide")){l.unwrap();for(var r=0;r<l.length;r+=4)l.slice(r,r+4).wrapAll('<div class="slide"></div>')}else for(var r=0;r<l.length;r+=4)l.slice(r,r+4).wrapAll('<div class="slide"></div>');if(minWidth(1450))if(l.parent().is(".slide")){l.unwrap();for(var r=0;r<l.length;r+=5)l.slice(r,r+5).wrapAll('<div class="slide"></div>')}else for(var r=0;r<l.length;r+=5)l.slice(r,r+5).wrapAll('<div class="slide"></div>');if(minWidth(800)&&maxWidth(1200))if(l.parent().is(".slide")){l.unwrap();for(var r=0;r<l.length;r+=3)l.slice(r,r+3).wrapAll('<div class="slide"></div>')}else for(var r=0;r<l.length;r+=3)l.slice(r,r+3).wrapAll('<div class="slide"></div>')})}function ug_viewAllLayout(e,i,s,l){$(e).children(".wrapper").hasClass("view-all")?($(l).text("View All"),$(e).addClass("line"),$(e).removeClass("grid"),$(".ug.grid-slider."+i+" .prev").removeClass("hidden"),$(".ug.grid-slider."+i+" .next").removeClass("hidden"),$(e).css("transform","translateX(0)"),$(e).attr("data-shift-amount","0"),$(e).children(".wrapper").removeClass("view-all"),$(s).attr("class","slide"),ug_gridSliderActiveSet()):($(l).text("View Less"),$(e).removeClass("line"),$(e).addClass("grid"),$(".ug.grid-slider."+i+" .prev").addClass("hidden"),$(".ug.grid-slider."+i+" .next").addClass("hidden"),$(e).css("transform","translateX(0)"),$(e).attr("data-shift-amount","0"),$(e).children(".wrapper").addClass("view-all"),$(s).attr("class","slide active"))}function ug_gridSliderDefaults(){$(".ug.grid-slider").each(function(e,i){$(this).children().children(".slide-wrapper").children().children().first().addClass("active"),$(this).children().children(".lead").children().children(".prev").addClass("disabled"),$(this).children().children(".slide-wrapper").attr("data-shift-amount","0");var s=$(this).children().children(".slide-wrapper").children().children(".slide").length;1>=s&&$(this).children().children(".lead").children(".controls").hide()})}function ug_viewAllDefaults(){$(".ug.grid-slider").each(function(){var e=$(this).children().children(".slide-wrapper"),i=$(this).attr("class").split(" ").pop(),s=e.children().children(".slide");e.hasClass("grid")&&($(".ug.grid-slider."+i+" .button.view-all").text("View Less"),$(e).removeClass("line"),$(e).addClass("grid"),$(".ug.grid-slider."+i+" .prev").addClass("hidden"),$(".ug.grid-slider."+i+" .next").addClass("hidden"),$(e).css("transform","translateX(0)"),$(e).attr("data-shift-amount","0"),$(e).children(".wrapper").addClass("view-all"),$(s).attr("class","slide active"))})}function ug_gridSliderActiveSet(){$(".ug.grid-slider .slide-wrapper").each(function(){var e=$(this).attr("data-shift-amount"),i=-1*e/100+1;$(this).children().length;$(this).children().children(".slide:nth-child("+i+")").addClass("active")})}function ug_disabledButtons(e,i,s){i===s?($(".ug.grid-slider."+e+" .next").addClass("disabled"),0!==i&&$(".ug.grid-slider."+e+" .prev").removeClass("disabled")):0===i?($(".ug.grid-slider."+e+" .prev").addClass("disabled"),i!==s&&$(".ug.grid-slider."+e+" .next").removeClass("disabled")):$(".ug.grid-slider."+e+" .button").removeClass("disabled"),0===s&&console.log("No shit")}function ug_slideLeft(e,i,s,l,r,a){e+=i,$(s).css("transform","translateX("+e+"%)"),$(s).attr("data-shift-amount",e),$(l).prev().addClass("active"),$(l).removeClass("active"),setTimeout(function(){ug_disabledButtons(r,e,a)},50)}function ug_slideRight(e,i,s,l,r,a){e-=i,$(s).css("transform","translateX("+e+"%)"),$(s).attr("data-shift-amount",e),$(l).next().addClass("active"),$(l).removeClass("active"),setTimeout(function(){ug_disabledButtons(r,e,a)},50)}function ug_LightboxOpen(e){var i=e.attr("box");console.log(i),$(".ug.lightbox[box='0']").addClass("open"),positionFauxed(!0)}function ug_LightboxClose(e){var i=e.parent().attr("class").split(" ").pop();$(".ug.lightbox."+i).removeClass("open"),positionFauxed(!1)}function ug_sliderLayout(){$(".ug.slider").each(function(e){$(this).addClass(""+e);var i=$(this),s=i.find(".slide-wrapper"),l=(s.find(".slide").length,$(this).attr("class").split(" ").pop()),r=$(".ug.slider."+l+" .slide-wrapper a");if($(this).children(".arrows").children(".prev").addClass("disabled"),i.attr("slide-shown","0"),console.log(r.length),r.parent().is(".slide")){r.unwrap();for(var a=0;a<r.length;a+=4)r.slice(a,a+4).wrapAll('<div class="slide"></div>')}else for(var a=0;a<r.length;a+=4)r.slice(a,a+4).wrapAll('<div class="slide"></div>');if(minWidth(1450))if(console.log("true?"),r.parent().is(".slide")){r.unwrap();for(var a=0;a<r.length;a+=5)r.slice(a,a+5).wrapAll('<div class="slide"></div>'),console.log(a)}else for(var a=0;a<r.length;a+=5)r.slice(a,a+5).wrapAll('<div class="slide"></div>');if(minWidth(800)&&maxWidth(1200))if(r.parent().is(".slide")){r.unwrap();for(var a=0;a<r.length;a+=3)r.slice(a,a+3).wrapAll('<div class="slide"></div>')}else for(var a=0;a<r.length;a+=3)r.slice(a,a+3).wrapAll('<div class="slide"></div>')})}function ug_sliderShift(e){if(self=e.parents(".ug.slider"),slideWrapper=self.find(".slide-wrapper .wrapper"),count=self.find(".slide").length,slideAmount=100,slideShown=parseInt(self.attr("slide-shown")),arrows=self.find(".arrows"),progress=self.find(".progress"),clickedArrow=e.attr("class").split(" ")[0],"next"===clickedArrow){slideShown++,self.attr("slide-shown",slideShown);var i=slideAmount*(-1*slideShown);slideWrapper.velocity({translateX:i+"%"},{duration:250,delay:0})}else{slideShown--,self.attr("slide-shown",slideShown);var i=slideAmount*(-1*slideShown);slideWrapper.velocity({translateX:i+"%"},{duration:250,delay:0})}progress.children("a").removeClass("active"),progress.children("a:nth-of-type("+(1+slideShown)+")").addClass("active"),0===slideShown?arrows.children(".prev").addClass("disabled"):slideShown+1===count?arrows.children(".next").addClass("disabled"):arrows.children().removeClass("disabled")}ug_gridSliderLayout(),ug_gridSliderDefaults(),ug_viewAllDefaults(),$(window).resize(function(){ug_gridSliderLayout(),ug_gridSliderActiveSet()}),$(".ug.grid-slider .button").click(function(e){e.preventDefault();var i=$(this),s=$(this).attr("class").split(" ").pop(),l=$(this).parent().parent().parent().parent().attr("class").split(" ").pop(),r=$(this).parent().parent().parent().children(".slide-wrapper"),a=r.children().children(".slide"),t=r.children().children(".active"),d=100,n=(parseInt(r.children().children(".slide").length,10)-1)*d*-1,o=parseInt(r.attr("data-shift-amount"),0);"next"===s?ug_slideRight(o,d,r,t,l,n):"prev"===s?ug_slideLeft(o,d,r,t,l,n):"view-all"===s&&ug_viewAllLayout(r,l,a,i),ug_disabledButtons(l,o,n)}),$(".ug.grid-slider .product").click(function(e){var i=$(this).parent(),s=$(this).parent().parent().parent(),l=s.parent().parent().attr("class").split(" ").pop(),r=parseInt(s.attr("data-shift-amount"),0),a=100,t=(parseInt(s.children().children(".slide").length,10)-1)*a*-1,d=(s.children().children(".slide"),s.children().children(".active"));i.hasClass("active")||(e.preventDefault(),i.prev().hasClass("active")?ug_slideRight(r,a,s,d,l,t):i.next().hasClass("active")&&ug_slideLeft(r,a,s,d,l,t))}),$(".ug nav.global").clone().appendTo("header.ug.global div.menu"),$(".ug div.menu .menu-trigger").click(function(){$(this).parent().toggleClass("open")}),$(".ug .dropdown").click(function(){$(this).toggleClass("open")}),$(".ug .lightbox-trigger").click(function(e){e.preventDefault(),ug_LightboxOpen($(this))}),$(".ug.lightbox .close").click(function(e){e.preventDefault(),ug_LightboxClose($(this))}),$(window).resize(function(){ug_sliderLayout()}),$(".ug.slider .arrows a").click(function(e){e.preventDefault(),ug_sliderShift($(this))}),ug_sliderLayout();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UtZnVuY3Rpb25zL2Jhc2UuanMiLCJiYXNlLWZ1bmN0aW9ucy9jb21wb25lbnRzL2ZhdXgtcG9zaXRpb24uanMiLCJiYXNlLWZ1bmN0aW9ucy9vYmplY3RzL2dyaWQtc2xpZGVyLmpzIiwiYmFzZS1mdW5jdGlvbnMvb2JqZWN0cy9saWdodGJveC5qcyIsImJhc2UtZnVuY3Rpb25zL29iamVjdHMvc2xpZGVyLmpzIiwiYmFzZS1mdW5jdGlvbnMvb2JqZWN0cy9oZWFkZXIuanMiXSwibmFtZXMiOlsibWluV2lkdGgiLCJ3aWR0aCIsInNjcmVlbldpZHRoIiwiJCIsIndpbmRvdyIsIm1heFdpZHRoIiwicG9zaXRpb25GYXV4ZWQiLCJvbiIsImhlYWRlck9mZnNldCIsInBhcnNlSW50IiwiaGVpZ2h0IiwiZmFrZVNjcm9sbCIsInNjcm9sbFRvcCIsInNjcm9sbEFtb3VudCIsImNzcyIsImFkZENsYXNzIiwic2V0VGltZW91dCIsInJlbW92ZUNsYXNzIiwidWdfZ3JpZFNsaWRlckxheW91dCIsImVhY2giLCJpbmRleCIsInZhbHVlIiwidGhpcyIsInNsaWRlck51bWJlciIsImF0dHIiLCJzcGxpdCIsInBvcCIsInByb2R1Y3RzIiwiY29uc29sZSIsImxvZyIsInBhcmVudCIsImlzIiwidW53cmFwIiwiaSIsImxlbmd0aCIsInNsaWNlIiwid3JhcEFsbCIsInVnX3ZpZXdBbGxMYXlvdXQiLCJjdXJyZW50V3JhcHBlciIsImN1cnJlbnRTbGlkZXJDbGFzcyIsImN1cnJlbnRTbGlkZXMiLCJidXR0b24iLCJjaGlsZHJlbiIsImhhc0NsYXNzIiwidGV4dCIsInVnX2dyaWRTbGlkZXJBY3RpdmVTZXQiLCJ1Z19ncmlkU2xpZGVyRGVmYXVsdHMiLCJmaXJzdCIsInNsaWRlTnVtYmVyIiwiaGlkZSIsInVnX3ZpZXdBbGxEZWZhdWx0cyIsInNsaWRlQW1vdW50IiwiYWN0aXZlU2xpZGUiLCJ1Z19kaXNhYmxlZEJ1dHRvbnMiLCJjdXJyZW50QW1vdW50IiwicG90ZW50aWFsU2hpZnQiLCJ1Z19zbGlkZUxlZnQiLCJzaGlmdEFtb3VudCIsImN1cnJlbnRBY3RpdmVTbGlkZSIsInByZXYiLCJ1Z19zbGlkZVJpZ2h0IiwibmV4dCIsInVnX0xpZ2h0Ym94T3BlbiIsInRyaWdnZXIiLCJhY3RpdmVCb3giLCJ1Z19MaWdodGJveENsb3NlIiwidWdfc2xpZGVyTGF5b3V0Iiwic2VsZiIsInNsaWRlV3JhcHBlciIsImZpbmQiLCJzbGlkZXMiLCJ1Z19zbGlkZXJTaGlmdCIsImFycm93IiwicGFyZW50cyIsImNvdW50Iiwic2xpZGVTaG93biIsImFycm93cyIsInByb2dyZXNzIiwiY2xpY2tlZEFycm93Iiwic2xpZGVUb3RhbCIsInZlbG9jaXR5IiwidHJhbnNsYXRlWCIsImR1cmF0aW9uIiwiZGVsYXkiLCJyZXNpemUiLCJjbGljayIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInR5cGUiLCJwYXJlbnRTbGlkZSIsImNsb25lIiwiYXBwZW5kVG8iLCJ0b2dnbGVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsVUFBQUMsR0FDQSxHQUFBQyxHQUFBQyxFQUFBQyxRQUFBSCxPQUNBLE9BQUFDLElBQUFELEVBT0EsUUFBQUksVUFBQUosR0FDQSxHQUFBQyxHQUFBQyxFQUFBQyxRQUFBSCxPQUNBLE9BQUFBLElBQUFDLEVDVEEsUUFBQUksZ0JBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsU0FBQU4sRUFBQSxpQkFBQU8sU0FBQSxJQUNBQyxFQUFBUixFQUFBQyxRQUFBUSxZQUFBSixFQUNBSyxFQUFBSixTQUFBTixFQUFBLGlCQUFBVyxJQUFBLE9BQUEsSUFBQU4sQ0FDQUssR0FBQUosU0FBQUksRUFBQSxJQUNBQSxFQUFBLEdBQUFBLEVBRUFOLEtBQUEsR0FDQUosRUFBQSxRQUFBWSxTQUFBLFlBQ0FaLEVBQUEsUUFBQVcsSUFBQSxRQUFBLEdBQUFILEtBSUFLLFdBQUEsV0FDQWIsRUFBQSxRQUFBYyxZQUFBLFlBQ0FkLEVBQUEsUUFBQVcsSUFBQSxNQUFBLEtBQ0FYLEVBQUFDLFFBQUFR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SSxXQUFBQSxTQUFBLFVBQ0FKLEVBQUFJLFdBQUFBLFNBQUEsV0FLQStDLEdBQUE5QyxTQUFBLFlBQ0EyQyxFQUFBQyxpQkFFQUUsRUFBQTlCLE9BQUFoQixTQUFBLFVBQ0FpQixjQUFBTixFQUFBRyxFQUFBbkIsRUFBQW9CLEVBQUFuQixFQUFBZ0IsR0FDQWtDLEVBQUE1QixPQUFBbEIsU0FBQSxXQUNBYSxhQUFBRixFQUFBRyxFQUFBbkIsRUFBQW9CLEVBQUFuQixFQUFBZ0IsTUcvUUFwRCxFQUFBLGtCQUFBdUYsUUFBQUMsU0FBQSw2QkFFQXhGLEVBQUEsOEJBQUFrRixNQUFBLFdBQ0FsRixFQUFBbUIsTUFBQVEsU0FBQThELFlBQUEsVUFHQXpGLEVBQUEsaUJBQUFrRixNQUFBLFdBQ0FsRixFQUFBbUIsTUFBQXNFLFlBQUEsVUZlQXpGLEVBQUEseUJBQUFrRixNQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGlCQUVBekIsZ0JBQUEzRCxFQUFBbUIsU0FJQW5CLEVBQUEsdUJBQUFrRixNQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGlCQUVBdEIsaUJBQUE5RCxFQUFBbUIsU0MyRkFuQixFQUFBQyxRQUFBZ0YsT0FBQSxXQUNBbEIsb0JBR0EvRCxFQUFBLHdCQUFBa0YsTUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxpQkFDQWhCLGVBQUFwRSxFQUFBbUIsU0FJQTRDIiwiZmlsZSI6ImFwcGxpY2F0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbWluV2lkdGgod2lkdGgpIHtcbiAgdmFyIHNjcmVlbldpZHRoID0gICQod2luZG93KS53aWR0aCgpO1xuICBpZiAoIHNjcmVlbldpZHRoID49IHdpZHRoICkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBtYXhXaWR0aCh3aWR0aCkge1xuICB2YXIgc2NyZWVuV2lkdGggPSAgJCh3aW5kb3cpLndpZHRoKCk7XG4gIGlmICggc2NyZWVuV2lkdGggPD0gd2lkdGggKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG4iLCIvLyBUaGlzIGZ1bmN0aW9uIHRha2VzIGNhcmUgb2YgYWxsIHRoZSB3ZWlyIGlzc3VlcyB5b3UgbWlnaHQgcnVuIGludG8gd2hlbiB0cnlpbmcgdG8gZG8gYSBmaXhlZCBwb3NpdGlvbiBvdmVybGF5IG9uIG1vYmlsZS5cblxuZnVuY3Rpb24gcG9zaXRpb25GYXV4ZWQob24pe1xuICB2YXIgaGVhZGVyT2Zmc2V0ID0gcGFyc2VJbnQoJChcImhlYWRlci5nbG9iYWxcIikuaGVpZ2h0KCksIDEwKTtcbiAgdmFyIGZha2VTY3JvbGwgPSAkKHdpbmRvdykuc2Nyb2xsVG9wKCkgLSBoZWFkZXJPZmZzZXQ7XG4gIHZhciBzY3JvbGxBbW91bnQgPSBwYXJzZUludCgkKFwibWFpbi5ub3Njcm9sbFwiKS5jc3MoXCJ0b3BcIiksIDEwKSAtIGhlYWRlck9mZnNldDtcbiAgc2Nyb2xsQW1vdW50ID0gcGFyc2VJbnQoc2Nyb2xsQW1vdW50LCAxMCk7XG4gIHNjcm9sbEFtb3VudCA9IHNjcm9sbEFtb3VudCAqIC0xO1xuXG4gIGlmKG9uID09PSB0cnVlKXtcbiAgICAkKFwibWFpblwiKS5hZGRDbGFzcyhcIm5vc2Nyb2xsXCIpO1xuICAgICQoXCJtYWluXCIpLmNzcyhcInRvcFwiLCArIChmYWtlU2Nyb2xsICAqIC0xKSk7XG5cbiAgfSBlbHNlIHtcblxuICAgIHNldFRpbWVvdXQoIGZ1bmN0aW9uKCl7XG4gICAgICAkKFwibWFpblwiKS5yZW1vdmVDbGFzcyhcIm5vc2Nyb2xsXCIpO1xuICAgICAgJChcIm1haW5cIikuY3NzKFwidG9wXCIsIFwiMFwiKTtcbiAgICAgICQod2luZG93KS5zY3JvbGxUb3Aoc2Nyb2xsQW1vdW50KTtcbiAgICB9LCAxKTtcblxuICB9XG59XG4iLCJmdW5jdGlvbiB1Z19ncmlkU2xpZGVyTGF5b3V0KCl7XG4gIC8vIEFkZGluZyBhIHVuaXF1ZSBjbGFzcyB0byBlYWNoIHNsaWRlciBmb3IgZGlmZmVyZW50aWF0aW9uIG9mXG4gICQoXCIudWcuZ3JpZC1zbGlkZXJcIikuZWFjaCggZnVuY3Rpb24oIGluZGV4LCB2YWx1ZSApIHtcblxuICAgICQodGhpcykuYWRkQ2xhc3MoXCJcIiArIGluZGV4KTtcblxuICAgIHZhciBzbGlkZXJOdW1iZXIgPSAkKHRoaXMpLmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIikucG9wKCksXG5cbiAgICBwcm9kdWN0cyA9ICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBzbGlkZXJOdW1iZXIgKyBcIiAud3JhcHBlciBhXCIpO1xuXG4gICAgY29uc29sZS5sb2cocHJvZHVjdHMpO1xuXG4gICAgaWYoIHByb2R1Y3RzLnBhcmVudCgpLmlzKFwiLnNsaWRlXCIpICkge1xuXG4gICAgICBwcm9kdWN0cy51bndyYXAoKTtcblxuICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBwcm9kdWN0cy5sZW5ndGg7IGkrPTQgKSB7XG4gICAgICAgIHByb2R1Y3RzLnNsaWNlKGksIGkrNCkud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICB9XG5cbiAgICB9IGVsc2Uge1xuXG4gICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSs9NCApIHtcbiAgICAgICAgcHJvZHVjdHMuc2xpY2UoaSwgaSs0KS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgIH1cblxuICAgIH1cblxuICAgIGlmICggbWluV2lkdGgoMTQ1MCkgKSB7XG4gICAgICBpZiggcHJvZHVjdHMucGFyZW50KCkuaXMoXCIuc2xpZGVcIikgKSB7XG4gICAgICAgIHByb2R1Y3RzLnVud3JhcCgpO1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSs9NSApIHtcbiAgICAgICAgICBwcm9kdWN0cy5zbGljZShpLCBpKzUpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSs9NSApIHtcbiAgICAgICAgICBwcm9kdWN0cy5zbGljZShpLCBpKzUpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCBtaW5XaWR0aCg4MDApICYmIG1heFdpZHRoKDEyMDApICkge1xuICAgICAgaWYoIHByb2R1Y3RzLnBhcmVudCgpLmlzKFwiLnNsaWRlXCIpICkge1xuICAgICAgICBwcm9kdWN0cy51bndyYXAoKTtcbiAgICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBwcm9kdWN0cy5sZW5ndGg7IGkrPTMgKSB7XG4gICAgICAgICAgcHJvZHVjdHMuc2xpY2UoaSwgaSszKS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBwcm9kdWN0cy5sZW5ndGg7IGkrPTMgKSB7XG4gICAgICAgICAgcHJvZHVjdHMuc2xpY2UoaSwgaSszKS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICB9KTtcbn1cblxuZnVuY3Rpb24gdWdfdmlld0FsbExheW91dChjdXJyZW50V3JhcHBlciwgY3VycmVudFNsaWRlckNsYXNzLCBjdXJyZW50U2xpZGVzLCBidXR0b24pIHtcblxuICBpZiggJChjdXJyZW50V3JhcHBlcikuY2hpbGRyZW4oXCIud3JhcHBlclwiKS5oYXNDbGFzcyhcInZpZXctYWxsXCIpICl7XG5cbiAgICAkKGJ1dHRvbikudGV4dChcIlZpZXcgQWxsXCIpO1xuXG4gICAgJChjdXJyZW50V3JhcHBlcikuYWRkQ2xhc3MoXCJsaW5lXCIpO1xuICAgICQoY3VycmVudFdyYXBwZXIpLnJlbW92ZUNsYXNzKFwiZ3JpZFwiKTtcblxuICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAucHJldlwiKS5yZW1vdmVDbGFzcyhcImhpZGRlblwiKTtcbiAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLm5leHRcIikucmVtb3ZlQ2xhc3MoXCJoaWRkZW5cIik7XG5cbiAgICAkKGN1cnJlbnRXcmFwcGVyKS5jc3MoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGVYKDApXCIpO1xuICAgICQoY3VycmVudFdyYXBwZXIpLmF0dHIoXCJkYXRhLXNoaWZ0LWFtb3VudFwiLCBcIjBcIik7XG5cbiAgICAkKGN1cnJlbnRXcmFwcGVyKS5jaGlsZHJlbihcIi53cmFwcGVyXCIpLnJlbW92ZUNsYXNzKFwidmlldy1hbGxcIik7XG4gICAgJChjdXJyZW50U2xpZGVzKS5hdHRyKFwiY2xhc3NcIiwgXCJzbGlkZVwiKTtcblxuICAgIHVnX2dyaWRTbGlkZXJBY3RpdmVTZXQoKTtcblxuICB9IGVsc2Uge1xuXG4gICAgJChidXR0b24pLnRleHQoXCJWaWV3IExlc3NcIik7XG5cbiAgICAkKGN1cnJlbnRXcmFwcGVyKS5yZW1vdmVDbGFzcyhcImxpbmVcIik7XG4gICAgJChjdXJyZW50V3JhcHBlcikuYWRkQ2xhc3MoXCJncmlkXCIpO1xuXG4gICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5wcmV2XCIpLmFkZENsYXNzKFwiaGlkZGVuXCIpO1xuICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAubmV4dFwiKS5hZGRDbGFzcyhcImhpZGRlblwiKTtcblxuICAgICQoY3VycmVudFdyYXBwZXIpLmNzcyhcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZVgoMClcIik7XG4gICAgJChjdXJyZW50V3JhcHBlcikuYXR0cihcImRhdGEtc2hpZnQtYW1vdW50XCIsIFwiMFwiKTtcblxuICAgICQoY3VycmVudFdyYXBwZXIpLmNoaWxkcmVuKFwiLndyYXBwZXJcIikuYWRkQ2xhc3MoXCJ2aWV3LWFsbFwiKTtcbiAgICAkKGN1cnJlbnRTbGlkZXMpLmF0dHIoXCJjbGFzc1wiLCBcInNsaWRlIGFjdGl2ZVwiKTtcblxuICB9XG5cbn1cblxuLy8gU2V0dGluZyBzb21lIGRlZmF1bHRzIGZvciBlYWNoIHNsaWRlclxuZnVuY3Rpb24gdWdfZ3JpZFNsaWRlckRlZmF1bHRzKCkge1xuICAkKFwiLnVnLmdyaWQtc2xpZGVyXCIpLmVhY2goIGZ1bmN0aW9uKGluZGV4LCB2YWx1ZSkge1xuICAgICQodGhpcykuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5zbGlkZS13cmFwcGVyXCIpLmNoaWxkcmVuKCkuY2hpbGRyZW4oKS5maXJzdCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAgICQodGhpcykuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5sZWFkXCIpLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIucHJldlwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgICQodGhpcykuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5zbGlkZS13cmFwcGVyXCIpLmF0dHIoXCJkYXRhLXNoaWZ0LWFtb3VudFwiLCBcIjBcIik7XG5cbiAgICB2YXIgc2xpZGVOdW1iZXIgPSAkKHRoaXMpLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGUtd3JhcHBlclwiKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlXCIpLmxlbmd0aDtcblxuICAgIGlmKHNsaWRlTnVtYmVyIDw9IDEpe1xuICAgICAgJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLmxlYWRcIikuY2hpbGRyZW4oXCIuY29udHJvbHNcIikuaGlkZSgpO1xuICAgIH1cbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHVnX3ZpZXdBbGxEZWZhdWx0cygpIHtcblxuICAkKFwiLnVnLmdyaWQtc2xpZGVyXCIpLmVhY2goIGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIGN1cnJlbnRXcmFwcGVyID0gJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlLXdyYXBwZXJcIiksXG4gICAgY3VycmVudFNsaWRlckNsYXNzID0gJCh0aGlzKS5hdHRyKFwiY2xhc3NcIikuc3BsaXQoXCIgXCIpLnBvcCgpLFxuICAgIGN1cnJlbnRTbGlkZXMgPSBjdXJyZW50V3JhcHBlci5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlXCIpO1xuXG4gICAgaWYoY3VycmVudFdyYXBwZXIuaGFzQ2xhc3MoXCJncmlkXCIpKXtcblxuICAgICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5idXR0b24udmlldy1hbGxcIikudGV4dChcIlZpZXcgTGVzc1wiKTtcblxuICAgICAgJChjdXJyZW50V3JhcHBlcikucmVtb3ZlQ2xhc3MoXCJsaW5lXCIpO1xuICAgICAgJChjdXJyZW50V3JhcHBlcikuYWRkQ2xhc3MoXCJncmlkXCIpO1xuXG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnByZXZcIikuYWRkQ2xhc3MoXCJoaWRkZW5cIik7XG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLm5leHRcIikuYWRkQ2xhc3MoXCJoaWRkZW5cIik7XG5cbiAgICAgICQoY3VycmVudFdyYXBwZXIpLmNzcyhcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZVgoMClcIik7XG4gICAgICAkKGN1cnJlbnRXcmFwcGVyKS5hdHRyKFwiZGF0YS1zaGlmdC1hbW91bnRcIiwgXCIwXCIpO1xuXG4gICAgICAkKGN1cnJlbnRXcmFwcGVyKS5jaGlsZHJlbihcIi53cmFwcGVyXCIpLmFkZENsYXNzKFwidmlldy1hbGxcIik7XG4gICAgICAkKGN1cnJlbnRTbGlkZXMpLmF0dHIoXCJjbGFzc1wiLCBcInNsaWRlIGFjdGl2ZVwiKTtcblxuICAgIH1cblxuICB9KTtcblxufTtcblxuLy8gU2V0dGluZyB0aGUgZmlyc3Qgc2xpZGUgYWN0aXZlXG5mdW5jdGlvbiB1Z19ncmlkU2xpZGVyQWN0aXZlU2V0KCkge1xuICAkKFwiLnVnLmdyaWQtc2xpZGVyIC5zbGlkZS13cmFwcGVyXCIpLmVhY2goIGZ1bmN0aW9uKCl7XG4gICAgdmFyIHNsaWRlQW1vdW50ID0gJCh0aGlzKS5hdHRyKFwiZGF0YS1zaGlmdC1hbW91bnRcIiksXG4gICAgYWN0aXZlU2xpZGUgPSAoc2xpZGVBbW91bnQgKiAtMSAvIDEwMCkgKyAxLFxuICAgIHNsaWRlTnVtYmVyID0gJCh0aGlzKS5jaGlsZHJlbigpLmxlbmd0aDtcblxuICAgICQodGhpcykuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5zbGlkZTpudGgtY2hpbGQoXCIgKyBhY3RpdmVTbGlkZSArIFwiKVwiKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuICB9KTtcbn1cblxuLy8gQ3JlYXRpbmcgYSBmdW5jdGlvbiB0byBkaXNhYmxlIHRoZSBhcnJvdyBidXR0b25zIGJhc2VkIG9uIHNsaWRlIHBvc2l0aW9uXG5mdW5jdGlvbiB1Z19kaXNhYmxlZEJ1dHRvbnMoY3VycmVudFNsaWRlckNsYXNzLCBjdXJyZW50QW1vdW50LCBwb3RlbnRpYWxTaGlmdCkge1xuICBpZihjdXJyZW50QW1vdW50ID09PSBwb3RlbnRpYWxTaGlmdCl7XG4gICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5uZXh0XCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgaWYgKCBjdXJyZW50QW1vdW50ICE9PSAwICl7XG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnByZXZcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiggY3VycmVudEFtb3VudCA9PT0gMCApIHtcbiAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnByZXZcIikuYWRkQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICBpZiAoIGN1cnJlbnRBbW91bnQgIT09IHBvdGVudGlhbFNoaWZ0ICl7XG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLm5leHRcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgfVxuXG4gIGlmIChwb3RlbnRpYWxTaGlmdCA9PT0gMCkge1xuICAgIGNvbnNvbGUubG9nKFwiTm8gc2hpdFwiKTtcbiAgfVxuXG59XG5cbi8vIFNldHRpbmcgdXAgZnVuY3Rpb25zIGZvciBzaGlmdGluZyB0aGUgc2xpZGVycyBhcHByb3ByaWF0ZWx5XG5mdW5jdGlvbiB1Z19zbGlkZUxlZnQoY3VycmVudEFtb3VudCwgc2hpZnRBbW91bnQsIGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50QWN0aXZlU2xpZGUsIGN1cnJlbnRTbGlkZXJDbGFzcywgcG90ZW50aWFsU2hpZnQpe1xuXG4gIGN1cnJlbnRBbW91bnQgPSBjdXJyZW50QW1vdW50ICsgc2hpZnRBbW91bnQ7XG5cbiAgLy8gJChjdXJyZW50V3JhcHBlcikudmVsb2NpdHkoeyB0cmFuc2xhdGVYOiBjdXJyZW50QW1vdW50ICsgXCIlXCIgfSwgeyBkdXJhdGlvbjogNTAwLCBlYXNpbmc6IFwic3dpbmdcIn0pO1xuICAkKGN1cnJlbnRXcmFwcGVyKS5jc3MoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGVYKFwiICsgY3VycmVudEFtb3VudCArIFwiJSlcIik7XG4gICQoY3VycmVudFdyYXBwZXIpLmF0dHIoXCJkYXRhLXNoaWZ0LWFtb3VudFwiLCBjdXJyZW50QW1vdW50KTtcbiAgJChjdXJyZW50QWN0aXZlU2xpZGUpLnByZXYoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcbiAgJChjdXJyZW50QWN0aXZlU2xpZGUpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICB1Z19kaXNhYmxlZEJ1dHRvbnMoY3VycmVudFNsaWRlckNsYXNzLCBjdXJyZW50QW1vdW50LCBwb3RlbnRpYWxTaGlmdCk7XG4gIH0sIDUwKVxuXG59XG5cbmZ1bmN0aW9uIHVnX3NsaWRlUmlnaHQoY3VycmVudEFtb3VudCwgc2hpZnRBbW91bnQsIGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50QWN0aXZlU2xpZGUsIGN1cnJlbnRTbGlkZXJDbGFzcywgcG90ZW50aWFsU2hpZnQpe1xuXG4gIGN1cnJlbnRBbW91bnQgPSBjdXJyZW50QW1vdW50IC0gc2hpZnRBbW91bnQ7XG5cbiAgLy8gJChjdXJyZW50V3JhcHBlcikudmVsb2NpdHkoeyB0cmFuc2xhdGVYOiBjdXJyZW50QW1vdW50ICsgXCIlXCIgfSwgeyBkdXJhdGlvbjogNTAwLCBlYXNpbmc6IFwic3dpbmdcIn0pO1xuICAkKGN1cnJlbnRXcmFwcGVyKS5jc3MoXCJ0cmFuc2Zvcm1cIiwgXCJ0cmFuc2xhdGVYKFwiICsgY3VycmVudEFtb3VudCArIFwiJSlcIik7XG4gICQoY3VycmVudFdyYXBwZXIpLmF0dHIoXCJkYXRhLXNoaWZ0LWFtb3VudFwiLCBjdXJyZW50QW1vdW50KTtcbiAgJChjdXJyZW50QWN0aXZlU2xpZGUpLm5leHQoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcbiAgJChjdXJyZW50QWN0aXZlU2xpZGUpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xuXG4gIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICB1Z19kaXNhYmxlZEJ1dHRvbnMoY3VycmVudFNsaWRlckNsYXNzLCBjdXJyZW50QW1vdW50LCBwb3RlbnRpYWxTaGlmdCk7XG4gIH0sIDUwKVxuXG59XG5cbnVnX2dyaWRTbGlkZXJMYXlvdXQoKTtcbnVnX2dyaWRTbGlkZXJEZWZhdWx0cygpO1xudWdfdmlld0FsbERlZmF1bHRzKCk7XG5cblxuJCh3aW5kb3cpLnJlc2l6ZSggZnVuY3Rpb24oKSB7XG4gIHVnX2dyaWRTbGlkZXJMYXlvdXQoKTtcbiAgdWdfZ3JpZFNsaWRlckFjdGl2ZVNldCgpO1xufSk7XG5cblxuXG4kKFwiLnVnLmdyaWQtc2xpZGVyIC5idXR0b25cIikuY2xpY2soZnVuY3Rpb24oZSl7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgdmFyIGJ1dHRvbiA9ICQodGhpcyksXG4gIHR5cGUgPSAkKHRoaXMpLmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIikucG9wKCksXG4gIGN1cnJlbnRTbGlkZXJDbGFzcyA9ICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuYXR0cihcImNsYXNzXCIpLnNwbGl0KFwiIFwiKS5wb3AoKSxcbiAgY3VycmVudFdyYXBwZXIgPSAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLmNoaWxkcmVuKFwiLnNsaWRlLXdyYXBwZXJcIiksXG4gIGN1cnJlbnRTbGlkZXMgPSBjdXJyZW50V3JhcHBlci5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlXCIpLFxuICBjdXJyZW50QWN0aXZlU2xpZGUgPSBjdXJyZW50V3JhcHBlci5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLmFjdGl2ZVwiKSxcbiAgc2hpZnRBbW91bnQgPSAxMDAsXG4gIHBvdGVudGlhbFNoaWZ0ID0gKHBhcnNlSW50KGN1cnJlbnRXcmFwcGVyLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGVcIikubGVuZ3RoLCAxMCkgLSAxKSAqIHNoaWZ0QW1vdW50ICogLTEsXG4gIGN1cnJlbnRBbW91bnQgPSBwYXJzZUludChjdXJyZW50V3JhcHBlci5hdHRyKFwiZGF0YS1zaGlmdC1hbW91bnRcIiksIDApO1xuXG4gIGlmKHR5cGUgPT09IFwibmV4dFwiKXtcblxuICAgIHVnX3NsaWRlUmlnaHQoY3VycmVudEFtb3VudCwgc2hpZnRBbW91bnQsIGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50QWN0aXZlU2xpZGUsIGN1cnJlbnRTbGlkZXJDbGFzcywgcG90ZW50aWFsU2hpZnQpO1xuXG4gIH0gZWxzZSBpZiAodHlwZSA9PT0gXCJwcmV2XCIpe1xuXG4gICAgdWdfc2xpZGVMZWZ0KGN1cnJlbnRBbW91bnQsIHNoaWZ0QW1vdW50LCBjdXJyZW50V3JhcHBlciwgY3VycmVudEFjdGl2ZVNsaWRlLCBjdXJyZW50U2xpZGVyQ2xhc3MsIHBvdGVudGlhbFNoaWZ0KTtcblxuICB9IGVsc2UgaWYgKCB0eXBlID09PSBcInZpZXctYWxsXCIgKXtcblxuICAgIHVnX3ZpZXdBbGxMYXlvdXQoY3VycmVudFdyYXBwZXIsIGN1cnJlbnRTbGlkZXJDbGFzcywgY3VycmVudFNsaWRlcywgYnV0dG9uKTtcblxuICB9XG5cbiAgdWdfZGlzYWJsZWRCdXR0b25zKGN1cnJlbnRTbGlkZXJDbGFzcywgY3VycmVudEFtb3VudCwgcG90ZW50aWFsU2hpZnQpO1xuXG59KTtcblxuJChcIi51Zy5ncmlkLXNsaWRlciAucHJvZHVjdFwiKS5jbGljayggZnVuY3Rpb24oZSl7XG5cbiAgdmFyIHBhcmVudFNsaWRlID0gJCh0aGlzKS5wYXJlbnQoKSxcbiAgY3VycmVudFdyYXBwZXIgPSAkKHRoaXMpLnBhcmVudCgpLnBhcmVudCgpLnBhcmVudCgpLFxuICBjdXJyZW50U2xpZGVyQ2xhc3MgPSBjdXJyZW50V3JhcHBlci5wYXJlbnQoKS5wYXJlbnQoKS5hdHRyKFwiY2xhc3NcIikuc3BsaXQoXCIgXCIpLnBvcCgpLFxuICBjdXJyZW50QW1vdW50ID0gcGFyc2VJbnQoY3VycmVudFdyYXBwZXIuYXR0cihcImRhdGEtc2hpZnQtYW1vdW50XCIpLCAwKSxcbiAgc2hpZnRBbW91bnQgPSAxMDAsXG4gIHBvdGVudGlhbFNoaWZ0ID0gKHBhcnNlSW50KGN1cnJlbnRXcmFwcGVyLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGVcIikubGVuZ3RoLCAxMCkgLSAxKSAqIHNoaWZ0QW1vdW50ICogLTEsXG4gIGN1cnJlbnRTbGlkZXMgPSBjdXJyZW50V3JhcHBlci5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlXCIpLFxuICBjdXJyZW50QWN0aXZlU2xpZGUgPSBjdXJyZW50V3JhcHBlci5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLmFjdGl2ZVwiKTtcblxuICAvLyBjb25zb2xlLmxvZyhjdXJyZW50U2xpZGVyQ2xhc3MpO1xuXG5cbiAgaWYoICFwYXJlbnRTbGlkZS5oYXNDbGFzcyhcImFjdGl2ZVwiKSApe1xuICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgIGlmKCBwYXJlbnRTbGlkZS5wcmV2KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikgKSB7XG4gICAgICB1Z19zbGlkZVJpZ2h0KCBjdXJyZW50QW1vdW50LCBzaGlmdEFtb3VudCwgY3VycmVudFdyYXBwZXIsIGN1cnJlbnRBY3RpdmVTbGlkZSwgY3VycmVudFNsaWRlckNsYXNzLCBwb3RlbnRpYWxTaGlmdCApO1xuICAgIH0gZWxzZSBpZiAoIHBhcmVudFNsaWRlLm5leHQoKS5oYXNDbGFzcyhcImFjdGl2ZVwiKSApe1xuICAgICAgdWdfc2xpZGVMZWZ0KCBjdXJyZW50QW1vdW50LCBzaGlmdEFtb3VudCwgY3VycmVudFdyYXBwZXIsIGN1cnJlbnRBY3RpdmVTbGlkZSwgY3VycmVudFNsaWRlckNsYXNzLCBwb3RlbnRpYWxTaGlmdCApO1xuICAgIH1cblxuICB9XG59KTtcbiIsImZ1bmN0aW9uIHVnX0xpZ2h0Ym94T3Blbih0cmlnZ2VyKXtcblxuICB2YXIgYWN0aXZlQm94ID0gdHJpZ2dlci5hdHRyKFwiYm94XCIpO1xuXG4gIGNvbnNvbGUubG9nKGFjdGl2ZUJveCk7XG5cbiAgJChcIi51Zy5saWdodGJveFtib3g9JzAnXVwiICkuYWRkQ2xhc3MoXCJvcGVuXCIpO1xuXG4gIHBvc2l0aW9uRmF1eGVkKHRydWUpO1xuXG59XG5cbmZ1bmN0aW9uIHVnX0xpZ2h0Ym94Q2xvc2UodHJpZ2dlcil7XG5cbiAgdmFyIGFjdGl2ZUJveCA9IHRyaWdnZXIucGFyZW50KCkuYXR0cihcImNsYXNzXCIpLnNwbGl0KFwiIFwiKS5wb3AoKTtcblxuICAkKFwiLnVnLmxpZ2h0Ym94LlwiICsgYWN0aXZlQm94KS5yZW1vdmVDbGFzcyhcIm9wZW5cIik7XG5cbiAgcG9zaXRpb25GYXV4ZWQoZmFsc2UpO1xuXG59XG5cbiQoXCIudWcgLmxpZ2h0Ym94LXRyaWdnZXJcIikuY2xpY2soIGZ1bmN0aW9uKGUpe1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgdWdfTGlnaHRib3hPcGVuKCQodGhpcykpO1xuXG59KTtcblxuJChcIi51Zy5saWdodGJveCAuY2xvc2VcIikuY2xpY2soZnVuY3Rpb24oZSl7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICB1Z19MaWdodGJveENsb3NlKCQodGhpcykpO1xuXG59KTtcbiIsIi8vIE1hcmt1cCByZWZsZWN0ZWQgaW4gYmFzZS1lbGVtZW50cy9zbGlkZXIuaHRtbFxuXG5mdW5jdGlvbiB1Z19zbGlkZXJMYXlvdXQoKXtcblxuICAkKFwiLnVnLnNsaWRlclwiKS5lYWNoKCBmdW5jdGlvbihpbmRleCkge1xuXG4gICAgJCh0aGlzKS5hZGRDbGFzcyhcIlwiICsgaW5kZXgpO1xuXG4gICAgdmFyIHNlbGYgPSAkKHRoaXMpLFxuICAgIHNsaWRlV3JhcHBlciA9IHNlbGYuZmluZChcIi5zbGlkZS13cmFwcGVyXCIpLFxuICAgIGNvdW50ID0gc2xpZGVXcmFwcGVyLmZpbmQoXCIuc2xpZGVcIikubGVuZ3RoLFxuICAgIHdpZHRoID0gMTAwICogY291bnQgKyBcIiVcIixcbiAgICBzbGlkZXJOdW1iZXIgPSAkKHRoaXMpLmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIikucG9wKCksXG4gICAgc2xpZGVzID0gJChcIi51Zy5zbGlkZXIuXCIgKyBzbGlkZXJOdW1iZXIgKyBcIiAuc2xpZGUtd3JhcHBlciBhXCIpO1xuXG4gICAgJCh0aGlzKS5jaGlsZHJlbihcIi5hcnJvd3NcIikuY2hpbGRyZW4oXCIucHJldlwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuXG4gICAgc2VsZi5hdHRyKFwic2xpZGUtc2hvd25cIiwgXCIwXCIpO1xuXG4gICAgY29uc29sZS5sb2coc2xpZGVzLmxlbmd0aCk7XG5cblxuICAgIGlmKCBzbGlkZXMucGFyZW50KCkuaXMoXCIuc2xpZGVcIikgKSB7XG5cbiAgICAgIHNsaWRlcy51bndyYXAoKTtcblxuICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBzbGlkZXMubGVuZ3RoOyBpKz00ICkge1xuICAgICAgICBzbGlkZXMuc2xpY2UoaSwgaSs0KS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG5cbiAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgc2xpZGVzLmxlbmd0aDsgaSs9NCApIHtcbiAgICAgICAgc2xpZGVzLnNsaWNlKGksIGkrNCkud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICBpZiAoIG1pbldpZHRoKDE0NTApICkge1xuICAgICAgY29uc29sZS5sb2coXCJ0cnVlP1wiKTtcblxuICAgICAgaWYoIHNsaWRlcy5wYXJlbnQoKS5pcyhcIi5zbGlkZVwiKSApIHtcbiAgICAgICAgc2xpZGVzLnVud3JhcCgpO1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHNsaWRlcy5sZW5ndGg7IGkrPTUgKSB7XG4gICAgICAgICAgc2xpZGVzLnNsaWNlKGksIGkrNSkud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICAgICAgY29uc29sZS5sb2coaSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgc2xpZGVzLmxlbmd0aDsgaSs9NSApIHtcbiAgICAgICAgICBzbGlkZXMuc2xpY2UoaSwgaSs1KS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIGlmICggbWluV2lkdGgoODAwKSAmJiBtYXhXaWR0aCgxMjAwKSApIHtcbiAgICAgIGlmKCBzbGlkZXMucGFyZW50KCkuaXMoXCIuc2xpZGVcIikgKSB7XG4gICAgICAgIHNsaWRlcy51bndyYXAoKTtcbiAgICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBzbGlkZXMubGVuZ3RoOyBpKz0zICkge1xuICAgICAgICAgIHNsaWRlcy5zbGljZShpLCBpKzMpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHNsaWRlcy5sZW5ndGg7IGkrPTMgKSB7XG4gICAgICAgICAgc2xpZGVzLnNsaWNlKGksIGkrMykud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgfSk7XG5cbn1cblxuZnVuY3Rpb24gdWdfc2xpZGVyU2hpZnQoYXJyb3cpe1xuXG4gIHNlbGYgPSBhcnJvdy5wYXJlbnRzKFwiLnVnLnNsaWRlclwiKSxcbiAgc2xpZGVXcmFwcGVyID0gc2VsZi5maW5kKFwiLnNsaWRlLXdyYXBwZXIgLndyYXBwZXJcIiksXG4gIGNvdW50ID0gc2VsZi5maW5kKFwiLnNsaWRlXCIpLmxlbmd0aCxcbiAgc2xpZGVBbW91bnQgPSAxMDAsXG4gIHNsaWRlU2hvd24gPSBwYXJzZUludChzZWxmLmF0dHIoXCJzbGlkZS1zaG93blwiKSksXG4gIGFycm93cyA9IHNlbGYuZmluZChcIi5hcnJvd3NcIiksXG4gIHByb2dyZXNzID0gc2VsZi5maW5kKFwiLnByb2dyZXNzXCIpLFxuICBjbGlja2VkQXJyb3cgPSBhcnJvdy5hdHRyKFwiY2xhc3NcIikuc3BsaXQoXCIgXCIpWzBdO1xuXG4gIGlmKCBjbGlja2VkQXJyb3cgPT09IFwibmV4dFwiICl7XG5cbiAgICBzbGlkZVNob3duKys7XG4gICAgc2VsZi5hdHRyKCBcInNsaWRlLXNob3duXCIsIHNsaWRlU2hvd24gKTtcblxuICAgIHZhciBzbGlkZVRvdGFsID0gc2xpZGVBbW91bnQgKiAoc2xpZGVTaG93biAqIC0xKTtcblxuXG4gICAgc2xpZGVXcmFwcGVyLnZlbG9jaXR5KHsgdHJhbnNsYXRlWDogc2xpZGVUb3RhbCArIFwiJVwiIH0sIHsgZHVyYXRpb246IDI1MCwgZGVsYXk6IDAgfSk7XG5cbiAgfSBlbHNlIHtcblxuICAgIHNsaWRlU2hvd24tLTtcbiAgICBzZWxmLmF0dHIoIFwic2xpZGUtc2hvd25cIiwgc2xpZGVTaG93biApO1xuXG4gICAgdmFyIHNsaWRlVG90YWwgPSBzbGlkZUFtb3VudCAqICggc2xpZGVTaG93biAqIC0xKTtcblxuICAgIHNsaWRlV3JhcHBlci52ZWxvY2l0eSh7IHRyYW5zbGF0ZVg6IHNsaWRlVG90YWwgKyBcIiVcIiB9LCB7IGR1cmF0aW9uOiAyNTAsIGRlbGF5OiAwIH0pO1xuXG4gIH1cblxuICBwcm9ncmVzcy5jaGlsZHJlbihcImFcIikucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG4gIHByb2dyZXNzLmNoaWxkcmVuKFwiYTpudGgtb2YtdHlwZShcIiArICgxICsgc2xpZGVTaG93bikgKyBcIilcIikuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG5cbiAgaWYoIHNsaWRlU2hvd24gPT09IDAgKXtcblxuICAgIGFycm93cy5jaGlsZHJlbihcIi5wcmV2XCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG5cbiAgfSBlbHNlIGlmICggKHNsaWRlU2hvd24gKyAxKSA9PT0gY291bnQgKSB7XG5cbiAgICBhcnJvd3MuY2hpbGRyZW4oXCIubmV4dFwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuXG4gIH0gZWxzZSB7XG5cbiAgICBhcnJvd3MuY2hpbGRyZW4oKS5yZW1vdmVDbGFzcyhcImRpc2FibGVkXCIpO1xuXG4gIH1cblxufVxuXG5cbiQod2luZG93KS5yZXNpemUoIGZ1bmN0aW9uKCkge1xuICB1Z19zbGlkZXJMYXlvdXQoKTtcbn0pO1xuXG4kKFwiLnVnLnNsaWRlciAuYXJyb3dzIGFcIikuY2xpY2soIGZ1bmN0aW9uKGUpe1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIHVnX3NsaWRlclNoaWZ0KCQodGhpcykpO1xufSk7XG5cblxudWdfc2xpZGVyTGF5b3V0KCk7XG4iLCIkKFwiLnVnIG5hdi5nbG9iYWxcIikuY2xvbmUoKS5hcHBlbmRUbyhcImhlYWRlci51Zy5nbG9iYWwgZGl2Lm1lbnVcIik7XG5cbiQoXCIudWcgZGl2Lm1lbnUgLm1lbnUtdHJpZ2dlclwiKS5jbGljayggZnVuY3Rpb24oKXtcbiAgJCh0aGlzKS5wYXJlbnQoKS50b2dnbGVDbGFzcyhcIm9wZW5cIik7XG59KTtcblxuJChcIi51ZyAuZHJvcGRvd25cIikuY2xpY2soZnVuY3Rpb24oKXtcbiAgJCh0aGlzKS50b2dnbGVDbGFzcyhcIm9wZW5cIik7XG4gIC8vIENvbnNpZGVyIGFkZGluZyBpbiBjb2RlIHRvIGR5bmFtaWNhbGx5IHRyYWNrIHRoZSBoZWlnaHQgb2YgYSBnaXZlbiBkcm9wZG93blxufSk7XG4iXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=
