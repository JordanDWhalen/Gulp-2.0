function minWidth(e){var i=$(window).width();return i>=e}function maxWidth(e){var i=$(window).width();return e>=i}function positionFauxed(e){var i=parseInt($("header.global").height(),10),s=$(window).scrollTop()-i,l=parseInt($("main.noscroll").css("top"),10)-i;l=parseInt(l,10),l=-1*l,e===!0?($("main").addClass("noscroll"),$("main").css("top",+(-1*s))):setTimeout(function(){$("main").removeClass("noscroll"),$("main").css("top","0"),$(window).scrollTop(l)},1)}function ug_gridSliderLayout(){$(".ug.grid-slider").each(function(e,i){$(this).addClass(""+e);var s=$(this).attr("class").split(" ").pop(),l=$(".ug.grid-slider."+s+" .wrapper a");if(l.parent().is(".slide")){l.unwrap();for(var r=0;r<l.length;r+=4)l.slice(r,r+4).wrapAll('<div class="slide"></div>')}else for(var r=0;r<l.length;r+=4)l.slice(r,r+4).wrapAll('<div class="slide"></div>');if(minWidth(1450))if(l.parent().is(".slide")){l.unwrap();for(var r=0;r<l.length;r+=5)l.slice(r,r+5).wrapAll('<div class="slide"></div>')}else for(var r=0;r<l.length;r+=5)l.slice(r,r+5).wrapAll('<div class="slide"></div>');if(minWidth(800)&&maxWidth(1200))if(l.parent().is(".slide")){l.unwrap();for(var r=0;r<l.length;r+=3)l.slice(r,r+3).wrapAll('<div class="slide"></div>')}else for(var r=0;r<l.length;r+=3)l.slice(r,r+3).wrapAll('<div class="slide"></div>')})}function ug_viewAllLayout(e,i,s,l){$(e).children(".wrapper").hasClass("view-all")?($(l).text("View All"),$(e).addClass("line"),$(e).removeClass("grid"),$(".ug.grid-slider."+i+" .prev").removeClass("hidden"),$(".ug.grid-slider."+i+" .next").removeClass("hidden"),$(e).css("transform","translateX(0)"),$(e).attr("slide-shown","0"),$(e).children(".wrapper").removeClass("view-all"),$(s).attr("class","slide"),ug_gridSliderActiveSet()):($(l).text("View Less"),$(e).removeClass("line"),$(e).addClass("grid"),$(".ug.grid-slider."+i+" .prev").addClass("hidden"),$(".ug.grid-slider."+i+" .next").addClass("hidden"),$(e).css("transform","translateX(0)"),$(e).attr("slide-shown","0"),$(e).children(".wrapper").addClass("view-all"),$(s).attr("class","slide active"))}function ug_gridSliderDefaults(){$(".ug.grid-slider").each(function(e,i){$(this).children().children(".slide-wrapper").children().children().first().addClass("active"),$(this).children().children(".lead").children().children(".prev").addClass("disabled"),$(this).children().children(".slide-wrapper").attr("slide-shown","0");var s=$(this).children().children(".slide-wrapper").children().children(".slide").length;1>=s&&$(this).children().children(".lead").children(".controls").hide()})}function ug_viewAllDefaults(){$(".ug.grid-slider").each(function(){var e=$(this).children().children(".slide-wrapper"),i=$(this).attr("class").split(" ").pop(),s=e.children().children(".slide");e.hasClass("grid")&&($(".ug.grid-slider."+i+" .button.view-all").text("View Less"),$(e).removeClass("line"),$(e).addClass("grid"),$(".ug.grid-slider."+i+" .prev").addClass("hidden"),$(".ug.grid-slider."+i+" .next").addClass("hidden"),$(e).css("transform","translateX(0)"),$(e).attr("slide-shown","0"),$(e).children(".wrapper").addClass("view-all"),$(s).attr("class","slide active"))})}function ug_gridSliderActiveSet(){$(".ug.grid-slider .slide-wrapper").each(function(){var e=$(this).attr("slide-shown"),i=-1*e/100+1;$(this).children().length;$(this).children().children(".slide:nth-child("+i+")").addClass("active")})}function ug_disabledButtons(e){var i=$(".ug.grid-slider."+e+" .wrapper .slide").length-1,s=parseInt($(".ug.grid-slider."+e+" .slide-wrapper").attr("slide-shown"));console.log("Current Slide: "+s),console.log("Slide Total: "+i),console.log(".ug.grid-slider."+e+" .slide-wrapper"),s===i?($(".ug.grid-slider."+e+" .next").addClass("disabled"),0!==s&&$(".ug.grid-slider."+e+" .prev").removeClass("disabled")):0===s?($(".ug.grid-slider."+e+" .prev").addClass("disabled"),s!==i&&$(".ug.grid-slider."+e+" .next").removeClass("disabled")):$(".ug.grid-slider."+e+" .button").removeClass("disabled")}function ug_slideLeft(e,i,s,l,r){e--,slideAmount=-100*e,$(i).css("transform","translateX("+slideAmount+"%)"),$(i).attr("slide-shown",e),$(s).prev().addClass("active"),$(s).removeClass("active"),setTimeout(function(){ug_disabledButtons(l)},50)}function ug_slideRight(e,i,s,l,r){e++,slideAmount=-100*e,$(i).css("transform","translateX("+slideAmount+"%)"),$(i).attr("slide-shown",e),$(s).prev().addClass("active"),$(s).removeClass("active"),setTimeout(function(){ug_disabledButtons(l)},50)}function ug_LightboxOpen(e){var i=e.attr("box");console.log(i),$(".ug.lightbox[box='0']").addClass("open"),positionFauxed(!0)}function ug_LightboxClose(e){var i=e.parent().attr("class").split(" ").pop();$(".ug.lightbox."+i).removeClass("open"),positionFauxed(!1)}function ug_sliderLayout(){$(".ug.slider").each(function(e){$(this).addClass(""+e);var i=$(this),s=i.find(".slide-wrapper"),l=(s.find(".slide").length,$(this).attr("class").split(" ").pop()),r=$(".ug.slider."+l+" .slide-wrapper a");if($(this).children(".arrows").children(".prev").addClass("disabled"),i.attr("slide-shown","0"),r.parent().is(".slide")){r.unwrap();for(var d=0;d<r.length;d+=4)r.slice(d,d+4).wrapAll('<div class="slide"></div>')}else for(var d=0;d<r.length;d+=4)r.slice(d,d+4).wrapAll('<div class="slide"></div>');if(minWidth(1450))if(r.parent().is(".slide")){r.unwrap();for(var d=0;d<r.length;d+=5)r.slice(d,d+5).wrapAll('<div class="slide"></div>')}else for(var d=0;d<r.length;d+=5)r.slice(d,d+5).wrapAll('<div class="slide"></div>');if(minWidth(800)&&maxWidth(1200))if(r.parent().is(".slide")){r.unwrap();for(var d=0;d<r.length;d+=3)r.slice(d,d+3).wrapAll('<div class="slide"></div>')}else for(var d=0;d<r.length;d+=3)r.slice(d,d+3).wrapAll('<div class="slide"></div>')})}function ug_sliderShift(e){if(self=e.parents(".ug.slider"),slideWrapper=self.find(".slide-wrapper .wrapper"),count=self.find(".slide").length,slideAmount=100,slideShown=parseInt(self.attr("slide-shown")),arrows=self.find(".arrows"),progress=self.find(".progress"),clickedArrow=e.attr("class").split(" ")[0],"next"===clickedArrow){slideShown++,self.attr("slide-shown",slideShown);var i=slideAmount*(-1*slideShown);slideWrapper.velocity({translateX:i+"%"},{duration:250,delay:0})}else{slideShown--,self.attr("slide-shown",slideShown);var i=slideAmount*(-1*slideShown);slideWrapper.velocity({translateX:i+"%"},{duration:250,delay:0})}progress.children("a").removeClass("active"),progress.children("a:nth-of-type("+(1+slideShown)+")").addClass("active"),0===slideShown?arrows.children(".prev").addClass("disabled"):slideShown+1===count?arrows.children(".next").addClass("disabled"):arrows.children().removeClass("disabled")}function ug_sliderActiveSet(){$(".ug.slider .slide-wrapper").each(function(){var e=$(this).attr("slide-shown"),i=-1*e/100+1;$(this).children().length;$(this).children().children(".slide:nth-child("+i+")").addClass("active")})}ug_gridSliderLayout(),ug_gridSliderDefaults(),ug_viewAllDefaults(),$(window).resize(function(){ug_gridSliderLayout(),ug_gridSliderActiveSet()}),$(".ug.grid-slider .button").click(function(e){e.preventDefault();var i=$(this),s=$(this).attr("class").split(" ").pop(),l=$(this).parents(".grid-slider").attr("class").split(" ").pop(),r=$(this).parent().parent().parent().children(".slide-wrapper"),d=r.children().children(".slide"),a=r.children().children(".active"),t=parseInt(r.attr("slide-shown"),0);"next"===s?ug_slideRight(t,r,a,l):"prev"===s?ug_slideLeft(t,r,a,l):"view-all"===s&&ug_viewAllLayout(r,l,d,i),ug_disabledButtons(l)}),$(".ug.grid-slider .product").click(function(e){var i=$(this).parent(),s=$(this).parent().parent().parent(),l=s.parent().parent().attr("class").split(" ").pop(),r=parseInt(s.attr("slide-shown"),0),d=100,a=(parseInt(s.children().children(".slide").length,10)-1)*d*-1,t=(s.children().children(".slide"),s.children().children(".active"));i.hasClass("active")||(e.preventDefault(),i.prev().hasClass("active")?ug_slideRight(r,d,s,t,l,a):i.next().hasClass("active")&&ug_slideLeft(r,d,s,t,l,a))}),$(".ug nav.global").clone().appendTo("header.ug.global div.menu"),$(".ug div.menu .menu-trigger").click(function(){$(this).parent().toggleClass("open")}),$(".ug .dropdown").click(function(){$(this).toggleClass("open")}),$(".ug .lightbox-trigger").click(function(e){e.preventDefault(),ug_LightboxOpen($(this))}),$(".ug.lightbox .close").click(function(e){e.preventDefault(),ug_LightboxClose($(this))}),$(window).resize(function(){ug_sliderLayout()}),$(".ug.slider .arrows a").click(function(e){e.preventDefault(),ug_sliderShift($(this))}),ug_sliderLayout();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UtZnVuY3Rpb25zL2Jhc2UuanMiLCJiYXNlLWZ1bmN0aW9ucy9jb21wb25lbnRzL2ZhdXgtcG9zaXRpb24uanMiLCJiYXNlLWZ1bmN0aW9ucy9vYmplY3RzL2dyaWQtc2xpZGVyLmpzIiwiYmFzZS1mdW5jdGlvbnMvb2JqZWN0cy9saWdodGJveC5qcyIsImJhc2UtZnVuY3Rpb25zL29iamVjdHMvc2xpZGVyLmpzIiwiYmFzZS1mdW5jdGlvbnMvb2JqZWN0cy9oZWFkZXIuanMiXSwibmFtZXMiOlsibWluV2lkdGgiLCJ3aWR0aCIsInNjcmVlbldpZHRoIiwiJCIsIndpbmRvdyIsIm1heFdpZHRoIiwicG9zaXRpb25GYXV4ZWQiLCJvbiIsImhlYWRlck9mZnNldCIsInBhcnNlSW50IiwiaGVpZ2h0IiwiZmFrZVNjcm9sbCIsInNjcm9sbFRvcCIsInNjcm9sbEFtb3VudCIsImNzcyIsImFkZENsYXNzIiwic2V0VGltZW91dCIsInJlbW92ZUNsYXNzIiwidWdfZ3JpZFNsaWRlckxheW91dCIsImVhY2giLCJpbmRleCIsInZhbHVlIiwidGhpcyIsInNsaWRlck51bWJlciIsImF0dHIiLCJzcGxpdCIsInBvcCIsInByb2R1Y3RzIiwicGFyZW50IiwiaXMiLCJ1bndyYXAiLCJpIiwibGVuZ3RoIiwic2xpY2UiLCJ3cmFwQWxsIiwidWdfdmlld0FsbExheW91dCIsImN1cnJlbnRXcmFwcGVyIiwiY3VycmVudFNsaWRlckNsYXNzIiwiY3VycmVudFNsaWRlcyIsImJ1dHRvbiIsImNoaWxkcmVuIiwiaGFzQ2xhc3MiLCJ0ZXh0IiwidWdfZ3JpZFNsaWRlckFjdGl2ZVNldCIsInVnX2dyaWRTbGlkZXJEZWZhdWx0cyIsImZpcnN0Iiwic2xpZGVOdW1iZXIiLCJoaWRlIiwidWdfdmlld0FsbERlZmF1bHRzIiwic2xpZGVBbW91bnQiLCJhY3RpdmVTbGlkZSIsInVnX2Rpc2FibGVkQnV0dG9ucyIsInNsaWRlVG90YWwiLCJjdXJyZW50U2xpZGUiLCJjb25zb2xlIiwibG9nIiwidWdfc2xpZGVMZWZ0IiwiY3VycmVudEFjdGl2ZVNsaWRlIiwicG90ZW50aWFsU2hpZnQiLCJwcmV2IiwidWdfc2xpZGVSaWdodCIsInVnX0xpZ2h0Ym94T3BlbiIsInRyaWdnZXIiLCJhY3RpdmVCb3giLCJ1Z19MaWdodGJveENsb3NlIiwidWdfc2xpZGVyTGF5b3V0Iiwic2VsZiIsInNsaWRlV3JhcHBlciIsImZpbmQiLCJzbGlkZXMiLCJ1Z19zbGlkZXJTaGlmdCIsImFycm93IiwicGFyZW50cyIsImNvdW50Iiwic2xpZGVTaG93biIsImFycm93cyIsInByb2dyZXNzIiwiY2xpY2tlZEFycm93IiwidmVsb2NpdHkiLCJ0cmFuc2xhdGVYIiwiZHVyYXRpb24iLCJkZWxheSIsInVnX3NsaWRlckFjdGl2ZVNldCIsInJlc2l6ZSIsImNsaWNrIiwiZSIsInByZXZlbnREZWZhdWx0IiwidHlwZSIsImN1cnJlbnRBbW91bnQiLCJwYXJlbnRTbGlkZSIsInNoaWZ0QW1vdW50IiwibmV4dCIsImNsb25lIiwiYXBwZW5kVG8iLCJ0b2dnbGVDbGFzcyJdLCJtYXBwaW5ncyI6IkFBQUEsUUFBQUEsVUFBQUMsR0FDQSxHQUFBQyxHQUFBQyxFQUFBQyxRQUFBSCxPQUNBLE9BQUFDLElBQUFELEVBT0EsUUFBQUksVUFBQUosR0FDQSxHQUFBQyxHQUFBQyxFQUFBQyxRQUFBSCxPQUNBLE9BQUFBLElBQUFDLEVDVEEsUUFBQUksZ0JBQUFDLEdBQ0EsR0FBQUMsR0FBQUMsU0FBQU4sRUFBQSxpQkFBQU8sU0FBQSxJQUNBQyxFQUFBUixFQUFBQyxRQUFBUSxZQUFBSixFQUNBSyxFQUFBSixTQUFBTixFQUFBLGlCQUFBVyxJQUFBLE9BQUEsSUFBQU4sQ0FDQUssR0FBQUosU0FBQUksRUFBQSxJQUNBQSxFQUFBLEdBQUFBLEVBRUFOLEtBQUEsR0FDQUosRUFBQSxRQUFBWSxTQUFBLFlBQ0FaLEVBQUEsUUFBQVcsSUFBQSxRQUFBLEdBQUFILEtBSUFLLFdBQUEsV0FDQWIsRUFBQSxRQUFBYyxZQUFBLFlBQ0FkLEVB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QUMsTUFDQThELEVBQUEvRSxTQUFBMkIsRUFBQVosS0FBQSxlQUFBLEdBQ0FrRSxFQUFBLElBQ0FoQyxHQUFBakQsU0FBQTJCLEVBQUFJLFdBQUFBLFNBQUEsVUFBQVIsT0FBQSxJQUFBLEdBQUEwRCxFQUFBLEdBRUFqQyxHQURBckIsRUFBQUksV0FBQUEsU0FBQSxVQUNBSixFQUFBSSxXQUFBQSxTQUFBLFdBSUFpRCxHQUFBaEQsU0FBQSxZQUNBNEMsRUFBQUMsaUJBRUFHLEVBQUE5QixPQUFBbEIsU0FBQSxVQUNBbUIsY0FBQTRCLEVBQUFFLEVBQUF0RCxFQUFBcUIsRUFBQXBCLEVBQUFxQixHQUNBK0IsRUFBQUUsT0FBQWxELFNBQUEsV0FDQWUsYUFBQWdDLEVBQUFFLEVBQUF0RCxFQUFBcUIsRUFBQXBCLEVBQUFxQixNR3JSQXZELEVBQUEsa0JBQUF5RixRQUFBQyxTQUFBLDZCQUVBMUYsRUFBQSw4QkFBQWlGLE1BQUEsV0FDQWpGLEVBQUFtQixNQUFBTSxTQUFBa0UsWUFBQSxVQUdBM0YsRUFBQSxpQkFBQWlGLE1BQUEsV0FDQWpGLEVBQUFtQixNQUFBd0UsWUFBQSxVRmVBM0YsRUFBQSx5QkFBQWlGLE1BQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBRUF6QixnQkFBQTFELEVBQUFtQixTQUlBbkIsRUFBQSx1QkFBQWlGLE1BQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBRUF0QixpQkFBQTdELEVBQUFtQixTQ2tHQW5CLEVBQUFDLFFBQUErRSxPQUFBLFdBQ0FsQixvQkFHQTlELEVBQUEsd0JBQUFpRixNQUFBLFNBQUFDLEdBQ0FBLEVBQUFDLGlCQUNBaEIsZUFBQW5FLEVBQUFtQixTQUlBMkMiLCJmaWxlIjoiYXBwbGljYXRpb24uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBtaW5XaWR0aCh3aWR0aCkge1xuICB2YXIgc2NyZWVuV2lkdGggPSAgJCh3aW5kb3cpLndpZHRoKCk7XG4gIGlmICggc2NyZWVuV2lkdGggPj0gd2lkdGggKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5cbmZ1bmN0aW9uIG1heFdpZHRoKHdpZHRoKSB7XG4gIHZhciBzY3JlZW5XaWR0aCA9ICAkKHdpbmRvdykud2lkdGgoKTtcbiAgaWYgKCBzY3JlZW5XaWR0aCA8PSB3aWR0aCApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbiIsIi8vIFRoaXMgZnVuY3Rpb24gdGFrZXMgY2FyZSBvZiBhbGwgdGhlIHdlaXIgaXNzdWVzIHlvdSBtaWdodCBydW4gaW50byB3aGVuIHRyeWluZyB0byBkbyBhIGZpeGVkIHBvc2l0aW9uIG92ZXJsYXkgb24gbW9iaWxlLlxuXG5mdW5jdGlvbiBwb3NpdGlvbkZhdXhlZChvbil7XG4gIHZhciBoZWFkZXJPZmZzZXQgPSBwYXJzZUludCgkKFwiaGVhZGVyLmdsb2JhbFwiKS5oZWlnaHQoKSwgMTApO1xuICB2YXIgZmFrZVNjcm9sbCA9ICQod2luZG93KS5zY3JvbGxUb3AoKSAtIGhlYWRlck9mZnNldDtcbiAgdmFyIHNjcm9sbEFtb3VudCA9IHBhcnNlSW50KCQoXCJtYWluLm5vc2Nyb2xsXCIpLmNzcyhcInRvcFwiKSwgMTApIC0gaGVhZGVyT2Zmc2V0O1xuICBzY3JvbGxBbW91bnQgPSBwYXJzZUludChzY3JvbGxBbW91bnQsIDEwKTtcbiAgc2Nyb2xsQW1vdW50ID0gc2Nyb2xsQW1vdW50ICogLTE7XG5cbiAgaWYob24gPT09IHRydWUpe1xuICAgICQoXCJtYWluXCIpLmFkZENsYXNzKFwibm9zY3JvbGxcIik7XG4gICAgJChcIm1haW5cIikuY3NzKFwidG9wXCIsICsgKGZha2VTY3JvbGwgICogLTEpKTtcblxuICB9IGVsc2Uge1xuXG4gICAgc2V0VGltZW91dCggZnVuY3Rpb24oKXtcbiAgICAgICQoXCJtYWluXCIpLnJlbW92ZUNsYXNzKFwibm9zY3JvbGxcIik7XG4gICAgICAkKFwibWFpblwiKS5jc3MoXCJ0b3BcIiwgXCIwXCIpO1xuICAgICAgJCh3aW5kb3cpLnNjcm9sbFRvcChzY3JvbGxBbW91bnQpO1xuICAgIH0sIDEpO1xuXG4gIH1cbn1cbiIsImZ1bmN0aW9uIHVnX2dyaWRTbGlkZXJMYXlvdXQoKXtcbiAgLy8gQWRkaW5nIGEgdW5pcXVlIGNsYXNzIHRvIGVhY2ggc2xpZGVyIGZvciBkaWZmZXJlbnRpYXRpb24gb2ZcbiAgJChcIi51Zy5ncmlkLXNsaWRlclwiKS5lYWNoKCBmdW5jdGlvbiggaW5kZXgsIHZhbHVlICkge1xuXG4gICAgJCh0aGlzKS5hZGRDbGFzcyhcIlwiICsgaW5kZXgpO1xuXG4gICAgdmFyIHNsaWRlck51bWJlciA9ICQodGhpcykuYXR0cihcImNsYXNzXCIpLnNwbGl0KFwiIFwiKS5wb3AoKSxcblxuICAgIHByb2R1Y3RzID0gJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIHNsaWRlck51bWJlciArIFwiIC53cmFwcGVyIGFcIik7XG5cbiAgICBpZiggcHJvZHVjdHMucGFyZW50KCkuaXMoXCIuc2xpZGVcIikgKSB7XG5cbiAgICAgIHByb2R1Y3RzLnVud3JhcCgpO1xuXG4gICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSs9NCApIHtcbiAgICAgICAgcHJvZHVjdHMuc2xpY2UoaSwgaSs0KS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG5cbiAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgcHJvZHVjdHMubGVuZ3RoOyBpKz00ICkge1xuICAgICAgICBwcm9kdWN0cy5zbGljZShpLCBpKzQpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgfVxuXG4gICAgfVxuXG4gICAgaWYgKCBtaW5XaWR0aCgxNDUwKSApIHtcbiAgICAgIGlmKCBwcm9kdWN0cy5wYXJlbnQoKS5pcyhcIi5zbGlkZVwiKSApIHtcbiAgICAgICAgcHJvZHVjdHMudW53cmFwKCk7XG4gICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgcHJvZHVjdHMubGVuZ3RoOyBpKz01ICkge1xuICAgICAgICAgIHByb2R1Y3RzLnNsaWNlKGksIGkrNSkud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgcHJvZHVjdHMubGVuZ3RoOyBpKz01ICkge1xuICAgICAgICAgIHByb2R1Y3RzLnNsaWNlKGksIGkrNSkud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIG1pbldpZHRoKDgwMCkgJiYgbWF4V2lkdGgoMTIwMCkgKSB7XG4gICAgICBpZiggcHJvZHVjdHMucGFyZW50KCkuaXMoXCIuc2xpZGVcIikgKSB7XG4gICAgICAgIHByb2R1Y3RzLnVud3JhcCgpO1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSs9MyApIHtcbiAgICAgICAgICBwcm9kdWN0cy5zbGljZShpLCBpKzMpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHByb2R1Y3RzLmxlbmd0aDsgaSs9MyApIHtcbiAgICAgICAgICBwcm9kdWN0cy5zbGljZShpLCBpKzMpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gIH0pO1xufVxuXG5mdW5jdGlvbiB1Z192aWV3QWxsTGF5b3V0KGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50U2xpZGVyQ2xhc3MsIGN1cnJlbnRTbGlkZXMsIGJ1dHRvbikge1xuXG4gIGlmKCAkKGN1cnJlbnRXcmFwcGVyKS5jaGlsZHJlbihcIi53cmFwcGVyXCIpLmhhc0NsYXNzKFwidmlldy1hbGxcIikgKXtcblxuICAgICQoYnV0dG9uKS50ZXh0KFwiVmlldyBBbGxcIik7XG5cbiAgICAkKGN1cnJlbnRXcmFwcGVyKS5hZGRDbGFzcyhcImxpbmVcIik7XG4gICAgJChjdXJyZW50V3JhcHBlcikucmVtb3ZlQ2xhc3MoXCJncmlkXCIpO1xuXG4gICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5wcmV2XCIpLnJlbW92ZUNsYXNzKFwiaGlkZGVuXCIpO1xuICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAubmV4dFwiKS5yZW1vdmVDbGFzcyhcImhpZGRlblwiKTtcblxuICAgICQoY3VycmVudFdyYXBwZXIpLmNzcyhcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZVgoMClcIik7XG4gICAgJChjdXJyZW50V3JhcHBlcikuYXR0cihcInNsaWRlLXNob3duXCIsIFwiMFwiKTtcblxuICAgICQoY3VycmVudFdyYXBwZXIpLmNoaWxkcmVuKFwiLndyYXBwZXJcIikucmVtb3ZlQ2xhc3MoXCJ2aWV3LWFsbFwiKTtcbiAgICAkKGN1cnJlbnRTbGlkZXMpLmF0dHIoXCJjbGFzc1wiLCBcInNsaWRlXCIpO1xuXG4gICAgdWdfZ3JpZFNsaWRlckFjdGl2ZVNldCgpO1xuXG4gIH0gZWxzZSB7XG5cbiAgICAkKGJ1dHRvbikudGV4dChcIlZpZXcgTGVzc1wiKTtcblxuICAgICQoY3VycmVudFdyYXBwZXIpLnJlbW92ZUNsYXNzKFwibGluZVwiKTtcbiAgICAkKGN1cnJlbnRXcmFwcGVyKS5hZGRDbGFzcyhcImdyaWRcIik7XG5cbiAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnByZXZcIikuYWRkQ2xhc3MoXCJoaWRkZW5cIik7XG4gICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5uZXh0XCIpLmFkZENsYXNzKFwiaGlkZGVuXCIpO1xuXG4gICAgJChjdXJyZW50V3JhcHBlcikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWCgwKVwiKTtcbiAgICAkKGN1cnJlbnRXcmFwcGVyKS5hdHRyKFwic2xpZGUtc2hvd25cIiwgXCIwXCIpO1xuXG4gICAgJChjdXJyZW50V3JhcHBlcikuY2hpbGRyZW4oXCIud3JhcHBlclwiKS5hZGRDbGFzcyhcInZpZXctYWxsXCIpO1xuICAgICQoY3VycmVudFNsaWRlcykuYXR0cihcImNsYXNzXCIsIFwic2xpZGUgYWN0aXZlXCIpO1xuXG4gIH1cblxufVxuXG4vLyBTZXR0aW5nIHNvbWUgZGVmYXVsdHMgZm9yIGVhY2ggc2xpZGVyXG5mdW5jdGlvbiB1Z19ncmlkU2xpZGVyRGVmYXVsdHMoKSB7XG4gICQoXCIudWcuZ3JpZC1zbGlkZXJcIikuZWFjaCggZnVuY3Rpb24oaW5kZXgsIHZhbHVlKSB7XG4gICAgJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlLXdyYXBwZXJcIikuY2hpbGRyZW4oKS5jaGlsZHJlbigpLmZpcnN0KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICAgJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLmxlYWRcIikuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5wcmV2XCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG4gICAgJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlLXdyYXBwZXJcIikuYXR0cihcInNsaWRlLXNob3duXCIsIFwiMFwiKTtcblxuICAgIHZhciBzbGlkZU51bWJlciA9ICQodGhpcykuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5zbGlkZS13cmFwcGVyXCIpLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGVcIikubGVuZ3RoO1xuXG4gICAgaWYoc2xpZGVOdW1iZXIgPD0gMSl7XG4gICAgICAkKHRoaXMpLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIubGVhZFwiKS5jaGlsZHJlbihcIi5jb250cm9sc1wiKS5oaWRlKCk7XG4gICAgfVxuICB9KTtcbn1cblxuZnVuY3Rpb24gdWdfdmlld0FsbERlZmF1bHRzKCkge1xuXG4gICQoXCIudWcuZ3JpZC1zbGlkZXJcIikuZWFjaCggZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgY3VycmVudFdyYXBwZXIgPSAkKHRoaXMpLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGUtd3JhcHBlclwiKSxcbiAgICBjdXJyZW50U2xpZGVyQ2xhc3MgPSAkKHRoaXMpLmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIikucG9wKCksXG4gICAgY3VycmVudFNsaWRlcyA9IGN1cnJlbnRXcmFwcGVyLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGVcIik7XG5cbiAgICBpZihjdXJyZW50V3JhcHBlci5oYXNDbGFzcyhcImdyaWRcIikpe1xuXG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLmJ1dHRvbi52aWV3LWFsbFwiKS50ZXh0KFwiVmlldyBMZXNzXCIpO1xuXG4gICAgICAkKGN1cnJlbnRXcmFwcGVyKS5yZW1vdmVDbGFzcyhcImxpbmVcIik7XG4gICAgICAkKGN1cnJlbnRXcmFwcGVyKS5hZGRDbGFzcyhcImdyaWRcIik7XG5cbiAgICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAucHJldlwiKS5hZGRDbGFzcyhcImhpZGRlblwiKTtcbiAgICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAubmV4dFwiKS5hZGRDbGFzcyhcImhpZGRlblwiKTtcblxuICAgICAgJChjdXJyZW50V3JhcHBlcikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWCgwKVwiKTtcbiAgICAgICQoY3VycmVudFdyYXBwZXIpLmF0dHIoXCJzbGlkZS1zaG93blwiLCBcIjBcIik7XG5cbiAgICAgICQoY3VycmVudFdyYXBwZXIpLmNoaWxkcmVuKFwiLndyYXBwZXJcIikuYWRkQ2xhc3MoXCJ2aWV3LWFsbFwiKTtcbiAgICAgICQoY3VycmVudFNsaWRlcykuYXR0cihcImNsYXNzXCIsIFwic2xpZGUgYWN0aXZlXCIpO1xuXG4gICAgfVxuXG4gIH0pO1xuXG59O1xuXG4vLyBTZXR0aW5nIHRoZSBmaXJzdCBzbGlkZSBhY3RpdmVcbmZ1bmN0aW9uIHVnX2dyaWRTbGlkZXJBY3RpdmVTZXQoKSB7XG4gICQoXCIudWcuZ3JpZC1zbGlkZXIgLnNsaWRlLXdyYXBwZXJcIikuZWFjaCggZnVuY3Rpb24oKXtcbiAgICB2YXIgc2xpZGVBbW91bnQgPSAkKHRoaXMpLmF0dHIoXCJzbGlkZS1zaG93blwiKSxcbiAgICBhY3RpdmVTbGlkZSA9IChzbGlkZUFtb3VudCAqIC0xIC8gMTAwKSArIDEsXG4gICAgc2xpZGVOdW1iZXIgPSAkKHRoaXMpLmNoaWxkcmVuKCkubGVuZ3RoO1xuXG4gICAgJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlOm50aC1jaGlsZChcIiArIGFjdGl2ZVNsaWRlICsgXCIpXCIpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuXG4gIH0pO1xufVxuXG4vLyBDcmVhdGluZyBhIGZ1bmN0aW9uIHRvIGRpc2FibGUgdGhlIGFycm93IGJ1dHRvbnMgYmFzZWQgb24gc2xpZGUgcG9zaXRpb25cbmZ1bmN0aW9uIHVnX2Rpc2FibGVkQnV0dG9ucyggY3VycmVudFNsaWRlckNsYXNzICkge1xuXG4gIHZhciBzbGlkZVRvdGFsID0gKCQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAud3JhcHBlciAuc2xpZGVcIikubGVuZ3RoKSAtIDEsXG4gICAgICBjdXJyZW50U2xpZGUgPSBwYXJzZUludCgkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnNsaWRlLXdyYXBwZXJcIikuYXR0cihcInNsaWRlLXNob3duXCIpKTtcblxuICAgICAgY29uc29sZS5sb2coXCJDdXJyZW50IFNsaWRlOiBcIiArIGN1cnJlbnRTbGlkZSk7XG4gICAgICBjb25zb2xlLmxvZyhcIlNsaWRlIFRvdGFsOiBcIiArIChzbGlkZVRvdGFsKSlcbiAgICAgIGNvbnNvbGUubG9nKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnNsaWRlLXdyYXBwZXJcIik7XG5cblxuICBpZiggY3VycmVudFNsaWRlID09PSAoc2xpZGVUb3RhbCkpe1xuICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAubmV4dFwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgIGlmICggY3VycmVudFNsaWRlICE9PSAwICl7XG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLnByZXZcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSBpZiggY3VycmVudFNsaWRlID09PSAwICkge1xuICAgICQoXCIudWcuZ3JpZC1zbGlkZXIuXCIgKyBjdXJyZW50U2xpZGVyQ2xhc3MgKyBcIiAucHJldlwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuICAgIGlmICggY3VycmVudFNsaWRlICE9PSBzbGlkZVRvdGFsICl7XG4gICAgICAkKFwiLnVnLmdyaWQtc2xpZGVyLlwiICsgY3VycmVudFNsaWRlckNsYXNzICsgXCIgLm5leHRcIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgJChcIi51Zy5ncmlkLXNsaWRlci5cIiArIGN1cnJlbnRTbGlkZXJDbGFzcyArIFwiIC5idXR0b25cIikucmVtb3ZlQ2xhc3MoXCJkaXNhYmxlZFwiKTtcbiAgfVxuXG59XG5cbi8vIFNldHRpbmcgdXAgZnVuY3Rpb25zIGZvciBzaGlmdGluZyB0aGUgc2xpZGVycyBhcHByb3ByaWF0ZWx5XG5cbmZ1bmN0aW9uIHVnX3NsaWRlTGVmdChjdXJyZW50U2xpZGUsIGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50QWN0aXZlU2xpZGUsIGN1cnJlbnRTbGlkZXJDbGFzcywgcG90ZW50aWFsU2hpZnQpe1xuXG4gIGN1cnJlbnRTbGlkZS0tO1xuXG4gIHNsaWRlQW1vdW50ID0gY3VycmVudFNsaWRlICogLTEwMDtcblxuICAvLyAkKGN1cnJlbnRXcmFwcGVyKS52ZWxvY2l0eSh7IHRyYW5zbGF0ZVg6IGN1cnJlbnRBbW91bnQgKyBcIiVcIiB9LCB7IGR1cmF0aW9uOiA1MDAsIGVhc2luZzogXCJzd2luZ1wifSk7XG4gICQoY3VycmVudFdyYXBwZXIpLmNzcyhcInRyYW5zZm9ybVwiLCBcInRyYW5zbGF0ZVgoXCIgKyBzbGlkZUFtb3VudCArIFwiJSlcIik7XG4gICQoY3VycmVudFdyYXBwZXIpLmF0dHIoXCJzbGlkZS1zaG93blwiLCBjdXJyZW50U2xpZGUpO1xuICAkKGN1cnJlbnRBY3RpdmVTbGlkZSkucHJldigpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuICAkKGN1cnJlbnRBY3RpdmVTbGlkZSkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XG5cbiAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgIHVnX2Rpc2FibGVkQnV0dG9ucyhjdXJyZW50U2xpZGVyQ2xhc3MpO1xuICB9LCA1MClcblxufVxuXG5mdW5jdGlvbiB1Z19zbGlkZVJpZ2h0KGN1cnJlbnRTbGlkZSwgY3VycmVudFdyYXBwZXIsIGN1cnJlbnRBY3RpdmVTbGlkZSwgY3VycmVudFNsaWRlckNsYXNzLCBwb3RlbnRpYWxTaGlmdCl7XG5cbiAgY3VycmVudFNsaWRlKys7XG5cbiAgc2xpZGVBbW91bnQgPSBjdXJyZW50U2xpZGUgKiAtMTAwO1xuXG4gIC8vICQoY3VycmVudFdyYXBwZXIpLnZlbG9jaXR5KHsgdHJhbnNsYXRlWDogY3VycmVudEFtb3VudCArIFwiJVwiIH0sIHsgZHVyYXRpb246IDUwMCwgZWFzaW5nOiBcInN3aW5nXCJ9KTtcbiAgJChjdXJyZW50V3JhcHBlcikuY3NzKFwidHJhbnNmb3JtXCIsIFwidHJhbnNsYXRlWChcIiArIHNsaWRlQW1vdW50ICsgXCIlKVwiKTtcbiAgJChjdXJyZW50V3JhcHBlcikuYXR0cihcInNsaWRlLXNob3duXCIsIGN1cnJlbnRTbGlkZSk7XG4gICQoY3VycmVudEFjdGl2ZVNsaWRlKS5wcmV2KCkuYWRkQ2xhc3MoXCJhY3RpdmVcIik7XG4gICQoY3VycmVudEFjdGl2ZVNsaWRlKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcblxuICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgdWdfZGlzYWJsZWRCdXR0b25zKGN1cnJlbnRTbGlkZXJDbGFzcyk7XG4gIH0sIDUwKVxuXG59XG5cbnVnX2dyaWRTbGlkZXJMYXlvdXQoKTtcbnVnX2dyaWRTbGlkZXJEZWZhdWx0cygpO1xudWdfdmlld0FsbERlZmF1bHRzKCk7XG5cblxuJCh3aW5kb3cpLnJlc2l6ZSggZnVuY3Rpb24oKSB7XG4gIHVnX2dyaWRTbGlkZXJMYXlvdXQoKTtcbiAgdWdfZ3JpZFNsaWRlckFjdGl2ZVNldCgpO1xufSk7XG5cblxuXG4kKFwiLnVnLmdyaWQtc2xpZGVyIC5idXR0b25cIikuY2xpY2soZnVuY3Rpb24oZSl7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgdmFyIGJ1dHRvbiA9ICQodGhpcyksXG4gIHR5cGUgPSAkKHRoaXMpLmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIikucG9wKCksXG4gIGN1cnJlbnRTbGlkZXJDbGFzcyA9ICQodGhpcykucGFyZW50cyhcIi5ncmlkLXNsaWRlclwiKS5hdHRyKFwiY2xhc3NcIikuc3BsaXQoXCIgXCIpLnBvcCgpLFxuICBjdXJyZW50V3JhcHBlciA9ICQodGhpcykucGFyZW50KCkucGFyZW50KCkucGFyZW50KCkuY2hpbGRyZW4oXCIuc2xpZGUtd3JhcHBlclwiKSxcbiAgY3VycmVudFNsaWRlcyA9IGN1cnJlbnRXcmFwcGVyLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuc2xpZGVcIiksXG4gIGN1cnJlbnRBY3RpdmVTbGlkZSA9IGN1cnJlbnRXcmFwcGVyLmNoaWxkcmVuKCkuY2hpbGRyZW4oXCIuYWN0aXZlXCIpLFxuXG4gIGN1cnJlbnRBbW91bnQgPSBwYXJzZUludChjdXJyZW50V3JhcHBlci5hdHRyKFwic2xpZGUtc2hvd25cIiksIDApO1xuXG4gIGlmKHR5cGUgPT09IFwibmV4dFwiKXtcblxuICAgIHVnX3NsaWRlUmlnaHQoY3VycmVudEFtb3VudCwgY3VycmVudFdyYXBwZXIsIGN1cnJlbnRBY3RpdmVTbGlkZSwgY3VycmVudFNsaWRlckNsYXNzKTtcblxuICB9IGVsc2UgaWYgKHR5cGUgPT09IFwicHJldlwiKXtcblxuICAgIHVnX3NsaWRlTGVmdChjdXJyZW50QW1vdW50LCBjdXJyZW50V3JhcHBlciwgY3VycmVudEFjdGl2ZVNsaWRlLCBjdXJyZW50U2xpZGVyQ2xhc3MpO1xuXG4gIH0gZWxzZSBpZiAoIHR5cGUgPT09IFwidmlldy1hbGxcIiApe1xuXG4gICAgdWdfdmlld0FsbExheW91dChjdXJyZW50V3JhcHBlciwgY3VycmVudFNsaWRlckNsYXNzLCBjdXJyZW50U2xpZGVzLCBidXR0b24pO1xuXG4gIH1cblxuICB1Z19kaXNhYmxlZEJ1dHRvbnMoY3VycmVudFNsaWRlckNsYXNzKTtcblxufSk7XG5cbiQoXCIudWcuZ3JpZC1zbGlkZXIgLnByb2R1Y3RcIikuY2xpY2soIGZ1bmN0aW9uKGUpe1xuXG4gIHZhciBwYXJlbnRTbGlkZSA9ICQodGhpcykucGFyZW50KCksXG4gIGN1cnJlbnRXcmFwcGVyID0gJCh0aGlzKS5wYXJlbnQoKS5wYXJlbnQoKS5wYXJlbnQoKSxcbiAgY3VycmVudFNsaWRlckNsYXNzID0gY3VycmVudFdyYXBwZXIucGFyZW50KCkucGFyZW50KCkuYXR0cihcImNsYXNzXCIpLnNwbGl0KFwiIFwiKS5wb3AoKSxcbiAgY3VycmVudEFtb3VudCA9IHBhcnNlSW50KGN1cnJlbnRXcmFwcGVyLmF0dHIoXCJzbGlkZS1zaG93blwiKSwgMCksXG4gIHNoaWZ0QW1vdW50ID0gMTAwLFxuICBwb3RlbnRpYWxTaGlmdCA9IChwYXJzZUludChjdXJyZW50V3JhcHBlci5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlXCIpLmxlbmd0aCwgMTApIC0gMSkgKiBzaGlmdEFtb3VudCAqIC0xLFxuICBjdXJyZW50U2xpZGVzID0gY3VycmVudFdyYXBwZXIuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5zbGlkZVwiKSxcbiAgY3VycmVudEFjdGl2ZVNsaWRlID0gY3VycmVudFdyYXBwZXIuY2hpbGRyZW4oKS5jaGlsZHJlbihcIi5hY3RpdmVcIik7XG5cblxuXG4gIGlmKCAhcGFyZW50U2xpZGUuaGFzQ2xhc3MoXCJhY3RpdmVcIikgKXtcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICBpZiggcGFyZW50U2xpZGUucHJldigpLmhhc0NsYXNzKFwiYWN0aXZlXCIpICkge1xuICAgICAgdWdfc2xpZGVSaWdodCggY3VycmVudEFtb3VudCwgc2hpZnRBbW91bnQsIGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50QWN0aXZlU2xpZGUsIGN1cnJlbnRTbGlkZXJDbGFzcywgcG90ZW50aWFsU2hpZnQgKTtcbiAgICB9IGVsc2UgaWYgKCBwYXJlbnRTbGlkZS5uZXh0KCkuaGFzQ2xhc3MoXCJhY3RpdmVcIikgKXtcbiAgICAgIHVnX3NsaWRlTGVmdCggY3VycmVudEFtb3VudCwgc2hpZnRBbW91bnQsIGN1cnJlbnRXcmFwcGVyLCBjdXJyZW50QWN0aXZlU2xpZGUsIGN1cnJlbnRTbGlkZXJDbGFzcywgcG90ZW50aWFsU2hpZnQgKTtcbiAgICB9XG5cbiAgfVxufSk7XG4iLCJmdW5jdGlvbiB1Z19MaWdodGJveE9wZW4odHJpZ2dlcil7XG5cbiAgdmFyIGFjdGl2ZUJveCA9IHRyaWdnZXIuYXR0cihcImJveFwiKTtcblxuICBjb25zb2xlLmxvZyhhY3RpdmVCb3gpO1xuXG4gICQoXCIudWcubGlnaHRib3hbYm94PScwJ11cIiApLmFkZENsYXNzKFwib3BlblwiKTtcblxuICBwb3NpdGlvbkZhdXhlZCh0cnVlKTtcblxufVxuXG5mdW5jdGlvbiB1Z19MaWdodGJveENsb3NlKHRyaWdnZXIpe1xuXG4gIHZhciBhY3RpdmVCb3ggPSB0cmlnZ2VyLnBhcmVudCgpLmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIikucG9wKCk7XG5cbiAgJChcIi51Zy5saWdodGJveC5cIiArIGFjdGl2ZUJveCkucmVtb3ZlQ2xhc3MoXCJvcGVuXCIpO1xuXG4gIHBvc2l0aW9uRmF1eGVkKGZhbHNlKTtcblxufVxuXG4kKFwiLnVnIC5saWdodGJveC10cmlnZ2VyXCIpLmNsaWNrKCBmdW5jdGlvbihlKXtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHVnX0xpZ2h0Ym94T3BlbigkKHRoaXMpKTtcblxufSk7XG5cbiQoXCIudWcubGlnaHRib3ggLmNsb3NlXCIpLmNsaWNrKGZ1bmN0aW9uKGUpe1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgdWdfTGlnaHRib3hDbG9zZSgkKHRoaXMpKTtcblxufSk7XG4iLCIvLyBNYXJrdXAgcmVmbGVjdGVkIGluIGJhc2UtZWxlbWVudHMvc2xpZGVyLmh0bWxcblxuLy8gVE9ETzogUmVzZXR0aW5nIGxheW91dCBvbiByZXNpemUsIGN1cnJlbnRseSB0aGUgYnV0dG9ucyBiZWNvbWUgZGlzYWJsZWQgd2hlbmV2ZXIgdGhlIGdyaWQgY2hhbmdlcy5cblxuZnVuY3Rpb24gdWdfc2xpZGVyTGF5b3V0KCl7XG5cbiAgJChcIi51Zy5zbGlkZXJcIikuZWFjaCggZnVuY3Rpb24oaW5kZXgpIHtcblxuICAgICQodGhpcykuYWRkQ2xhc3MoXCJcIiArIGluZGV4KTtcblxuICAgIHZhciBzZWxmID0gJCh0aGlzKSxcbiAgICBzbGlkZVdyYXBwZXIgPSBzZWxmLmZpbmQoXCIuc2xpZGUtd3JhcHBlclwiKSxcbiAgICBjb3VudCA9IHNsaWRlV3JhcHBlci5maW5kKFwiLnNsaWRlXCIpLmxlbmd0aCxcbiAgICB3aWR0aCA9IDEwMCAqIGNvdW50ICsgXCIlXCIsXG4gICAgc2xpZGVyTnVtYmVyID0gJCh0aGlzKS5hdHRyKFwiY2xhc3NcIikuc3BsaXQoXCIgXCIpLnBvcCgpLFxuICAgIHNsaWRlcyA9ICQoXCIudWcuc2xpZGVyLlwiICsgc2xpZGVyTnVtYmVyICsgXCIgLnNsaWRlLXdyYXBwZXIgYVwiKTtcblxuICAgICQodGhpcykuY2hpbGRyZW4oXCIuYXJyb3dzXCIpLmNoaWxkcmVuKFwiLnByZXZcIikuYWRkQ2xhc3MoXCJkaXNhYmxlZFwiKTtcblxuICAgIHNlbGYuYXR0cihcInNsaWRlLXNob3duXCIsIFwiMFwiKTtcblxuICAgIGlmKCBzbGlkZXMucGFyZW50KCkuaXMoXCIuc2xpZGVcIikgKSB7XG5cbiAgICAgIHNsaWRlcy51bndyYXAoKTtcblxuICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBzbGlkZXMubGVuZ3RoOyBpKz00ICkge1xuICAgICAgICBzbGlkZXMuc2xpY2UoaSwgaSs0KS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgIH1cblxuICAgIH0gZWxzZSB7XG5cbiAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgc2xpZGVzLmxlbmd0aDsgaSs9NCApIHtcbiAgICAgICAgc2xpZGVzLnNsaWNlKGksIGkrNCkud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICB9XG5cbiAgICB9XG5cbiAgICBpZiAoIG1pbldpZHRoKDE0NTApICkge1xuXG4gICAgICBpZiggc2xpZGVzLnBhcmVudCgpLmlzKFwiLnNsaWRlXCIpICkge1xuICAgICAgICBzbGlkZXMudW53cmFwKCk7XG4gICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgc2xpZGVzLmxlbmd0aDsgaSs9NSApIHtcbiAgICAgICAgICBzbGlkZXMuc2xpY2UoaSwgaSs1KS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm9yKCB2YXIgaSA9IDA7IGkgPCBzbGlkZXMubGVuZ3RoOyBpKz01ICkge1xuICAgICAgICAgIHNsaWRlcy5zbGljZShpLCBpKzUpLndyYXBBbGwoJzxkaXYgY2xhc3M9XCJzbGlkZVwiPjwvZGl2PicpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCBtaW5XaWR0aCg4MDApICYmIG1heFdpZHRoKDEyMDApICkge1xuICAgICAgaWYoIHNsaWRlcy5wYXJlbnQoKS5pcyhcIi5zbGlkZVwiKSApIHtcbiAgICAgICAgc2xpZGVzLnVud3JhcCgpO1xuICAgICAgICBmb3IoIHZhciBpID0gMDsgaSA8IHNsaWRlcy5sZW5ndGg7IGkrPTMgKSB7XG4gICAgICAgICAgc2xpZGVzLnNsaWNlKGksIGkrMykud3JhcEFsbCgnPGRpdiBjbGFzcz1cInNsaWRlXCI+PC9kaXY+Jyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZvciggdmFyIGkgPSAwOyBpIDwgc2xpZGVzLmxlbmd0aDsgaSs9MyApIHtcbiAgICAgICAgICBzbGlkZXMuc2xpY2UoaSwgaSszKS53cmFwQWxsKCc8ZGl2IGNsYXNzPVwic2xpZGVcIj48L2Rpdj4nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICB9KTtcblxufVxuXG5mdW5jdGlvbiB1Z19zbGlkZXJTaGlmdChhcnJvdyl7XG5cbiAgc2VsZiA9IGFycm93LnBhcmVudHMoXCIudWcuc2xpZGVyXCIpLFxuICBzbGlkZVdyYXBwZXIgPSBzZWxmLmZpbmQoXCIuc2xpZGUtd3JhcHBlciAud3JhcHBlclwiKSxcbiAgY291bnQgPSBzZWxmLmZpbmQoXCIuc2xpZGVcIikubGVuZ3RoLFxuICBzbGlkZUFtb3VudCA9IDEwMCxcbiAgc2xpZGVTaG93biA9IHBhcnNlSW50KHNlbGYuYXR0cihcInNsaWRlLXNob3duXCIpKSxcbiAgYXJyb3dzID0gc2VsZi5maW5kKFwiLmFycm93c1wiKSxcbiAgcHJvZ3Jlc3MgPSBzZWxmLmZpbmQoXCIucHJvZ3Jlc3NcIiksXG4gIGNsaWNrZWRBcnJvdyA9IGFycm93LmF0dHIoXCJjbGFzc1wiKS5zcGxpdChcIiBcIilbMF07XG5cbiAgaWYoIGNsaWNrZWRBcnJvdyA9PT0gXCJuZXh0XCIgKXtcblxuICAgIHNsaWRlU2hvd24rKztcbiAgICBzZWxmLmF0dHIoIFwic2xpZGUtc2hvd25cIiwgc2xpZGVTaG93biApO1xuXG4gICAgdmFyIHNsaWRlVG90YWwgPSBzbGlkZUFtb3VudCAqIChzbGlkZVNob3duICogLTEpO1xuXG5cbiAgICBzbGlkZVdyYXBwZXIudmVsb2NpdHkoeyB0cmFuc2xhdGVYOiBzbGlkZVRvdGFsICsgXCIlXCIgfSwgeyBkdXJhdGlvbjogMjUwLCBkZWxheTogMCB9KTtcblxuICB9IGVsc2Uge1xuXG4gICAgc2xpZGVTaG93bi0tO1xuICAgIHNlbGYuYXR0ciggXCJzbGlkZS1zaG93blwiLCBzbGlkZVNob3duICk7XG5cbiAgICB2YXIgc2xpZGVUb3RhbCA9IHNsaWRlQW1vdW50ICogKCBzbGlkZVNob3duICogLTEpO1xuXG4gICAgc2xpZGVXcmFwcGVyLnZlbG9jaXR5KHsgdHJhbnNsYXRlWDogc2xpZGVUb3RhbCArIFwiJVwiIH0sIHsgZHVyYXRpb246IDI1MCwgZGVsYXk6IDAgfSk7XG5cbiAgfVxuXG4gIHByb2dyZXNzLmNoaWxkcmVuKFwiYVwiKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcbiAgcHJvZ3Jlc3MuY2hpbGRyZW4oXCJhOm50aC1vZi10eXBlKFwiICsgKDEgKyBzbGlkZVNob3duKSArIFwiKVwiKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcblxuICBpZiggc2xpZGVTaG93biA9PT0gMCApe1xuXG4gICAgYXJyb3dzLmNoaWxkcmVuKFwiLnByZXZcIikuYWRkQ2xhc3MoXCJkaXNhYmxlZFwiKTtcblxuICB9IGVsc2UgaWYgKCAoc2xpZGVTaG93biArIDEpID09PSBjb3VudCApIHtcblxuICAgIGFycm93cy5jaGlsZHJlbihcIi5uZXh0XCIpLmFkZENsYXNzKFwiZGlzYWJsZWRcIik7XG5cbiAgfSBlbHNlIHtcblxuICAgIGFycm93cy5jaGlsZHJlbigpLnJlbW92ZUNsYXNzKFwiZGlzYWJsZWRcIik7XG5cbiAgfVxuXG59XG5cbmZ1bmN0aW9uIHVnX3NsaWRlckFjdGl2ZVNldCgpIHtcbiAgJChcIi51Zy5zbGlkZXIgLnNsaWRlLXdyYXBwZXJcIikuZWFjaCggZnVuY3Rpb24oKXtcbiAgICB2YXIgc2xpZGVBbW91bnQgPSAkKHRoaXMpLmF0dHIoXCJzbGlkZS1zaG93blwiKSxcbiAgICBhY3RpdmVTbGlkZSA9IChzbGlkZUFtb3VudCAqIC0xIC8gMTAwKSArIDEsXG4gICAgc2xpZGVOdW1iZXIgPSAkKHRoaXMpLmNoaWxkcmVuKCkubGVuZ3RoO1xuXG4gICAgJCh0aGlzKS5jaGlsZHJlbigpLmNoaWxkcmVuKFwiLnNsaWRlOm50aC1jaGlsZChcIiArIGFjdGl2ZVNsaWRlICsgXCIpXCIpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xuXG4gIH0pO1xufVxuXG4kKHdpbmRvdykucmVzaXplKCBmdW5jdGlvbigpIHtcbiAgdWdfc2xpZGVyTGF5b3V0KCk7XG59KTtcblxuJChcIi51Zy5zbGlkZXIgLmFycm93cyBhXCIpLmNsaWNrKCBmdW5jdGlvbihlKXtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICB1Z19zbGlkZXJTaGlmdCgkKHRoaXMpKTtcbn0pO1xuXG5cbnVnX3NsaWRlckxheW91dCgpO1xuIiwiJChcIi51ZyBuYXYuZ2xvYmFsXCIpLmNsb25lKCkuYXBwZW5kVG8oXCJoZWFkZXIudWcuZ2xvYmFsIGRpdi5tZW51XCIpO1xuXG4kKFwiLnVnIGRpdi5tZW51IC5tZW51LXRyaWdnZXJcIikuY2xpY2soIGZ1bmN0aW9uKCl7XG4gICQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoXCJvcGVuXCIpO1xufSk7XG5cbiQoXCIudWcgLmRyb3Bkb3duXCIpLmNsaWNrKGZ1bmN0aW9uKCl7XG4gICQodGhpcykudG9nZ2xlQ2xhc3MoXCJvcGVuXCIpO1xuICAvLyBDb25zaWRlciBhZGRpbmcgaW4gY29kZSB0byBkeW5hbWljYWxseSB0cmFjayB0aGUgaGVpZ2h0IG9mIGEgZ2l2ZW4gZHJvcGRvd25cbn0pO1xuIl0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9
